{"remainingRequest":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\ConstructionConsultationSystem\\Frontend\\src\\views\\implement\\security\\Security.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\ConstructionConsultationSystem\\Frontend\\src\\views\\implement\\security\\Security.vue","mtime":1563457090052},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport echarts from 'echarts'\r\nimport SecurityModal from './components/SecurityModal'\r\nimport api from '../../../api/implement'\r\nimport { mapGetters } from 'vuex'\r\nimport ACol from 'ant-design-vue/es/grid/Col'\r\nimport ARow from 'ant-design-vue/es/grid/Row'\r\nimport moment from 'moment'\r\n\r\nconst columns = [\r\n  {\r\n    title: '序号',\r\n    dataIndex: 'risk_id',\r\n    scopedSlots: { customRender: 'risk_id' },\r\n    width: '10%',\r\n    align: 'center'\r\n  },\r\n  {\r\n    title: '内容',\r\n    dataIndex: 'risk_content',\r\n    width: '20%',\r\n    align: 'center'\r\n  },\r\n  {\r\n    title: '部位',\r\n    dataIndex: 'part',\r\n    width: '15%',\r\n    align: 'center'\r\n  },\r\n  {\r\n    title: '附件',\r\n    dataIndex: 'files',\r\n    scopedSlots: { customRender: 'files' },\r\n    width: '15%',\r\n    align: 'center'\r\n  },\r\n  {\r\n    title: '风险等级',\r\n    dataIndex: 'risk_rank',\r\n    width: '18%',\r\n    align: 'center'\r\n  },\r\n  {\r\n    title: '编辑',\r\n    dataIndex: 'operation',\r\n    scopedSlots: { customRender: 'operation' },\r\n    align: 'center'\r\n  }]\r\n// const columnHead = [\r\n//   {\r\n//     title: '类别',\r\n//     dataIndex: 'type',\r\n//     width: '15%',\r\n//     align: 'center'\r\n//   },\r\n//   {\r\n//     title: '职位',\r\n//     dataIndex: 'position',\r\n//     width: '18%',\r\n//     align: 'center'\r\n//   },\r\n//   {\r\n//     title: '姓名',\r\n//     dataIndex: 'name',\r\n//     width: '20%',\r\n//     align: 'center'\r\n//   },\r\n//   {\r\n//     title: '联系电话',\r\n//     dataIndex: 'phone',\r\n//     width: '25%',\r\n//     align: 'center'\r\n//   },\r\n//   {\r\n//     title: '编辑',\r\n//     dataIndex: 'operation',\r\n//     scopedSlots: { customRender: 'operation' },\r\n//     align: 'center'\r\n//   }\r\n// ]\r\nexport default {\r\n  name: 'Security',\r\n  components: {\r\n    ARow,\r\n    ACol,\r\n    SecurityModal\r\n  },\r\n  props: {\r\n    id: Number\r\n  },\r\n  data () {\r\n    return {\r\n      status: {\r\n        listLoading: true,\r\n        tableLoading: true\r\n      },\r\n      charts: '',\r\n      opinion: ['已回复', '未回复'],\r\n      opinionData: [\r\n        { value: 40, name: '已回复', itemStyle: { color: '#00b0f0' } },\r\n        { value: 60, name: '未回复', itemStyle: { color: '#7030a0' } },\r\n      ],\r\n      layout: {\r\n        'label-col': { span: 6 },\r\n        'wrapper-col': { span: 18 }\r\n      },\r\n      form: this.$form.createForm(this),\r\n      securityModal: {\r\n        record: null,\r\n        visible: false,\r\n        type: '1',\r\n        risk_id: this.id\r\n      },\r\n      columns,\r\n      matterList: [],\r\n      project_id: this.projectSelected().id,\r\n      starting_date: '',\r\n      Days: ''\r\n    }\r\n  },\r\n  mounted () {\r\n    this.$nextTick(function () {\r\n      this.drawPie('main')\r\n    })\r\n    this.getData()\r\n  },\r\n  methods: {\r\n    ...mapGetters(['projectSelected']),\r\n    getData () {\r\n      this.status.listLoading = false\r\n      this.status.tableLoading = false\r\n      api.getSecurityList(this.project_id)\r\n        .then(data => {\r\n          this.matterList = data\r\n          this.status.listLoading = false\r\n        })\r\n      api.getStartDate(this.project_id)\r\n        .then(data => {\r\n          this.status.listLoading = false\r\n          this.starting_date = data.starting_date\r\n          let today = new moment()\r\n          let starting_day = new moment(this.starting_date)\r\n          this.Days =`${today.diff(starting_day, 'days') + 1} `\r\n        })\r\n      api.getSecurityNotice(this.project_id)\r\n          .then(data => {\r\n            this.not_num = data.not_num\r\n            this.reply_num = data.reply_num\r\n            this.opinionData[0].value=this.reply_num\r\n            this.opinionData[1].value=this.not_num\r\n            this.$nextTick(function () {\r\n              this.drawPie('main')\r\n            })\r\n          })\r\n      // api.getSecurityHeadList(this.project_id)\r\n      //   .then(data => {\r\n      //     this.headList = data\r\n      //     this.status.tableLoading = false\r\n      //     console.log(1)\r\n      //   })\r\n    },\r\n    drawPie (id) {\r\n      this.charts = echarts.init(document.getElementById(id))\r\n      this.charts.setOption({\r\n        tooltip: {\r\n          trigger: 'item',\r\n        },\r\n        legend: {\r\n          orient: 'vertical',\r\n          x: 'left',\r\n          data: this.opinion\r\n        },\r\n        series: [\r\n          {\r\n            name: '数量',\r\n            type: 'pie',\r\n            radius: ['0%', '70%'],\r\n            avoidLabelOverlap: false,\r\n            label: {\r\n              normal: {\r\n                show: true,\r\n                position: 'inside'\r\n              },\r\n              emphasis: {\r\n                show: true,\r\n                textStyle: {\r\n                  fontSize: '30',\r\n                  fontWeight: 'bold'\r\n                }\r\n              }\r\n            },\r\n            labelLine: {\r\n              normal: {\r\n                show: false\r\n              }\r\n            },\r\n            data: this.opinionData\r\n          }\r\n        ]\r\n      })\r\n    },\r\n    handleSecurityClose () {\r\n      this.securityModal.type = ''\r\n      this.securityModal.record = null\r\n      this.securityModal.visible = false\r\n      this.getData()\r\n    },\r\n    handleSecurityCreate () {\r\n      this.securityModal.type = 'create'\r\n      this.securityModal.record = null\r\n      this.securityModal.visible = true\r\n    },\r\n    handleSecurityEdit (record) {\r\n      this.securityModal.type = 'edit'\r\n      this.securityModal.record = record\r\n      this.securityModal.visible = true\r\n    },\r\n    handleSecurityDelete (record) {\r\n      api.deleteSecurity(record.risk_id)\r\n        .then(data => {\r\n          this.$notification.success({ message: '成功', description: '删除成功', key: 'SUCCESS' })\r\n        })\r\n    }\r\n  }\r\n}\r\n",{"version":3,"sources":["Security.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoIA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Security.vue","sourceRoot":"src/views/implement/security","sourcesContent":["<template>\r\n  <div>\r\n    <a-card style=\"margin-bottom: 16px\">\r\n      <a-row>\r\n        <a-col\r\n          :xs=\"{ span: 24 }\"\r\n          :sm=\"{ span: 12 }\"\r\n          :xl=\"{ span: 12 }\">\r\n          <a-col style=\"text-align: center\"\r\n                 :xs=\"{ span: 24 }\"\r\n                 :sm=\"{ span: 16,offset:4 }\"\r\n                 :xl=\"{ span: 17,offset:4}\">\r\n            <a-row>\r\n              <iframe name=\"weather_inc\" src=\"http://i.tianqi.com/index.php?c=code&id=55\"\r\n                      style=\"border:solid 1px #7ec8ea\" height=\"300\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\"\r\n                      scrolling=\"no\"></iframe>\r\n            </a-row>\r\n            <a-row>\r\n              <a-card title=\"安全生产\" :bordered=true>\r\n                <p style=\"text-align: center\">{{Days}}天</p>\r\n              </a-card>\r\n            </a-row>\r\n          </a-col>\r\n        </a-col>\r\n        <a-col\r\n          :xs=\"{ span: 24 }\"\r\n          :sm=\"{ span: 12 }\"\r\n          :xl=\"{ span: 12 }\">\r\n          <div id=\"app\">\r\n            <div id=\"main\" style=\"width: 100%; height: 450px;\"></div>\r\n          </div>\r\n        </a-col>\r\n      </a-row>\r\n    </a-card>\r\n    <security-modal\r\n      :record=\"securityModal.record\"\r\n      :visible=\"securityModal.visible\"\r\n      :type=\"securityModal.type\"\r\n      :table_id=\"securityModal.risk_id\"\r\n      v-if=\"securityModal.visible\"\r\n      @close=\"handleSecurityClose()\">\r\n    </security-modal>\r\n    <a-card style=\"margin-bottom: 16px\">\r\n      <a-row style=\"margin-bottom: 5px\">\r\n        <a-col\r\n          class=\"item\"\r\n          :xs=\"{ span: 24 }\"\r\n          :sm=\"{ span: 12 ,offset:12}\"\r\n          :xl=\"{ span: 4 ,offset:20}\">\r\n          <a-button\r\n            type=\"primary\"\r\n            icon=\"plus\"\r\n            style=\"width: 100%\"\r\n            @click=\"handleSecurityCreate()\">\r\n            新建\r\n          </a-button>\r\n        </a-col>\r\n      </a-row>\r\n      <a-spin :spinning=\"status.listLoading\">\r\n        <a-table\r\n          bordered\r\n          :columns=\"columns\"\r\n          :dataSource=\"matterList\"\r\n          rowKey=\"risk_id\"\r\n          :pagination=\"false\">\r\n          <template slot=\"id\" slot-scope=\"text, record, index\">\r\n            <div>{{index+1}}</div>\r\n          </template>\r\n          <template slot=\"files\" slot-scope=\"text, record, index\">\r\n            <a-button @click=\"$router.push({'name': 'implementSecurityDetail', params: {id: record.risk_id}})\">\r\n              附件管理\r\n            </a-button>\r\n          </template>\r\n          <template slot=\"operation\" slot-scope=\"text, record, index\">\r\n            <a-button @click=\"handleSecurityEdit(record)\">编辑</a-button>\r\n            <a-popconfirm\r\n              title=\"确认删除吗?\"\r\n              @confirm=\"handleSecurityDelete(record)\">\r\n              <a-button type=\"danger\">删除</a-button>\r\n            </a-popconfirm>\r\n          </template>\r\n        </a-table>\r\n      </a-spin>\r\n      <a-col\r\n        :xs=\"{span: 24}\"\r\n        :sm=\"{span: 20, offset: 2}\"\r\n        :xl=\"{span: 16, offset: 4}\">\r\n      </a-col>\r\n    </a-card>\r\n    <!--<a-card style=\"margin-bottom: 16px\">-->\r\n    <!--<a-row style=\"margin-bottom: 5px\">-->\r\n    <!--<a-col-->\r\n    <!--class=\"item\"-->\r\n    <!--:xs=\"{ span: 24 }\"-->\r\n    <!--:sm=\"{ span: 12 ,offset:12}\"-->\r\n    <!--:xl=\"{ span: 4 ,offset:20}\">-->\r\n    <!--<a-button-->\r\n    <!--type=\"primary\"-->\r\n    <!--icon=\"plus\"-->\r\n    <!--style=\"width: 100%\"-->\r\n    <!--@click=\"handleSecurityHeadCreate()\">-->\r\n    <!--新建-->\r\n    <!--</a-button>-->\r\n    <!--</a-col>-->\r\n    <!--</a-row>-->\r\n    <!--&lt;!&ndash;<a-spin :spinning=\"status.tableLoading\">&ndash;&gt;-->\r\n    <!--<a-table-->\r\n    <!--bordered-->\r\n    <!--:columns=\"columnHead\"-->\r\n    <!--:dataSource=\"headList\"-->\r\n    <!--rowKey=\"head_id\"-->\r\n    <!--:pagination=\"false\">-->\r\n    <!--<template slot=\"operation\" slot-scope=\"text, record, index\">-->\r\n    <!--<a-button @click=\"handleSecurityEdit(record)\">编辑</a-button>-->\r\n    <!--<a-popconfirm-->\r\n    <!--title=\"确认删除吗?\"-->\r\n    <!--@confirm=\"handleSecurityDelete(record)\">-->\r\n    <!--<a-button type=\"danger\">删除</a-button>-->\r\n    <!--</a-popconfirm>-->\r\n    <!--</template>-->\r\n    <!--</a-table>-->\r\n    <!--&lt;!&ndash;</a-spin>&ndash;&gt;-->\r\n    <!--<a-col-->\r\n    <!--:xs=\"{span: 24}\"-->\r\n    <!--:sm=\"{span: 20, offset: 2}\"-->\r\n    <!--:xl=\"{span: 16, offset: 4}\">-->\r\n    <!--</a-col>-->\r\n    <!--</a-card>-->\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport echarts from 'echarts'\r\nimport SecurityModal from './components/SecurityModal'\r\nimport api from '../../../api/implement'\r\nimport { mapGetters } from 'vuex'\r\nimport ACol from 'ant-design-vue/es/grid/Col'\r\nimport ARow from 'ant-design-vue/es/grid/Row'\r\nimport moment from 'moment'\r\n\r\nconst columns = [\r\n  {\r\n    title: '序号',\r\n    dataIndex: 'risk_id',\r\n    scopedSlots: { customRender: 'risk_id' },\r\n    width: '10%',\r\n    align: 'center'\r\n  },\r\n  {\r\n    title: '内容',\r\n    dataIndex: 'risk_content',\r\n    width: '20%',\r\n    align: 'center'\r\n  },\r\n  {\r\n    title: '部位',\r\n    dataIndex: 'part',\r\n    width: '15%',\r\n    align: 'center'\r\n  },\r\n  {\r\n    title: '附件',\r\n    dataIndex: 'files',\r\n    scopedSlots: { customRender: 'files' },\r\n    width: '15%',\r\n    align: 'center'\r\n  },\r\n  {\r\n    title: '风险等级',\r\n    dataIndex: 'risk_rank',\r\n    width: '18%',\r\n    align: 'center'\r\n  },\r\n  {\r\n    title: '编辑',\r\n    dataIndex: 'operation',\r\n    scopedSlots: { customRender: 'operation' },\r\n    align: 'center'\r\n  }]\r\n// const columnHead = [\r\n//   {\r\n//     title: '类别',\r\n//     dataIndex: 'type',\r\n//     width: '15%',\r\n//     align: 'center'\r\n//   },\r\n//   {\r\n//     title: '职位',\r\n//     dataIndex: 'position',\r\n//     width: '18%',\r\n//     align: 'center'\r\n//   },\r\n//   {\r\n//     title: '姓名',\r\n//     dataIndex: 'name',\r\n//     width: '20%',\r\n//     align: 'center'\r\n//   },\r\n//   {\r\n//     title: '联系电话',\r\n//     dataIndex: 'phone',\r\n//     width: '25%',\r\n//     align: 'center'\r\n//   },\r\n//   {\r\n//     title: '编辑',\r\n//     dataIndex: 'operation',\r\n//     scopedSlots: { customRender: 'operation' },\r\n//     align: 'center'\r\n//   }\r\n// ]\r\nexport default {\r\n  name: 'Security',\r\n  components: {\r\n    ARow,\r\n    ACol,\r\n    SecurityModal\r\n  },\r\n  props: {\r\n    id: Number\r\n  },\r\n  data () {\r\n    return {\r\n      status: {\r\n        listLoading: true,\r\n        tableLoading: true\r\n      },\r\n      charts: '',\r\n      opinion: ['已回复', '未回复'],\r\n      opinionData: [\r\n        { value: 40, name: '已回复', itemStyle: { color: '#00b0f0' } },\r\n        { value: 60, name: '未回复', itemStyle: { color: '#7030a0' } },\r\n      ],\r\n      layout: {\r\n        'label-col': { span: 6 },\r\n        'wrapper-col': { span: 18 }\r\n      },\r\n      form: this.$form.createForm(this),\r\n      securityModal: {\r\n        record: null,\r\n        visible: false,\r\n        type: '1',\r\n        risk_id: this.id\r\n      },\r\n      columns,\r\n      matterList: [],\r\n      project_id: this.projectSelected().id,\r\n      starting_date: '',\r\n      Days: ''\r\n    }\r\n  },\r\n  mounted () {\r\n    this.$nextTick(function () {\r\n      this.drawPie('main')\r\n    })\r\n    this.getData()\r\n  },\r\n  methods: {\r\n    ...mapGetters(['projectSelected']),\r\n    getData () {\r\n      this.status.listLoading = false\r\n      this.status.tableLoading = false\r\n      api.getSecurityList(this.project_id)\r\n        .then(data => {\r\n          this.matterList = data\r\n          this.status.listLoading = false\r\n        })\r\n      api.getStartDate(this.project_id)\r\n        .then(data => {\r\n          this.status.listLoading = false\r\n          this.starting_date = data.starting_date\r\n          let today = new moment()\r\n          let starting_day = new moment(this.starting_date)\r\n          this.Days =`${today.diff(starting_day, 'days') + 1} `\r\n        })\r\n      api.getSecurityNotice(this.project_id)\r\n          .then(data => {\r\n            this.not_num = data.not_num\r\n            this.reply_num = data.reply_num\r\n            this.opinionData[0].value=this.reply_num\r\n            this.opinionData[1].value=this.not_num\r\n            this.$nextTick(function () {\r\n              this.drawPie('main')\r\n            })\r\n          })\r\n      // api.getSecurityHeadList(this.project_id)\r\n      //   .then(data => {\r\n      //     this.headList = data\r\n      //     this.status.tableLoading = false\r\n      //     console.log(1)\r\n      //   })\r\n    },\r\n    drawPie (id) {\r\n      this.charts = echarts.init(document.getElementById(id))\r\n      this.charts.setOption({\r\n        tooltip: {\r\n          trigger: 'item',\r\n        },\r\n        legend: {\r\n          orient: 'vertical',\r\n          x: 'left',\r\n          data: this.opinion\r\n        },\r\n        series: [\r\n          {\r\n            name: '数量',\r\n            type: 'pie',\r\n            radius: ['0%', '70%'],\r\n            avoidLabelOverlap: false,\r\n            label: {\r\n              normal: {\r\n                show: true,\r\n                position: 'inside'\r\n              },\r\n              emphasis: {\r\n                show: true,\r\n                textStyle: {\r\n                  fontSize: '30',\r\n                  fontWeight: 'bold'\r\n                }\r\n              }\r\n            },\r\n            labelLine: {\r\n              normal: {\r\n                show: false\r\n              }\r\n            },\r\n            data: this.opinionData\r\n          }\r\n        ]\r\n      })\r\n    },\r\n    handleSecurityClose () {\r\n      this.securityModal.type = ''\r\n      this.securityModal.record = null\r\n      this.securityModal.visible = false\r\n      this.getData()\r\n    },\r\n    handleSecurityCreate () {\r\n      this.securityModal.type = 'create'\r\n      this.securityModal.record = null\r\n      this.securityModal.visible = true\r\n    },\r\n    handleSecurityEdit (record) {\r\n      this.securityModal.type = 'edit'\r\n      this.securityModal.record = record\r\n      this.securityModal.visible = true\r\n    },\r\n    handleSecurityDelete (record) {\r\n      api.deleteSecurity(record.risk_id)\r\n        .then(data => {\r\n          this.$notification.success({ message: '成功', description: '删除成功', key: 'SUCCESS' })\r\n        })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n  .test {\r\n    color: #c82333;\r\n  }\r\n</style>"]}]}