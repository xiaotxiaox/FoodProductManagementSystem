{"remainingRequest":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\ConstructionConsultationSystem\\Frontend\\src\\views\\detail\\GPS.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\ConstructionConsultationSystem\\Frontend\\src\\views\\detail\\GPS.vue","mtime":1572875471532},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { mapMutations } from 'vuex'\r\nimport { mapGetters } from 'vuex'\r\nimport router from '../../router'\r\nimport PageLayout from '../../components/page/PageLayout'\r\nimport api from '../../api/project'\r\nimport ARow from 'ant-design-vue/es/grid/Row'\r\nimport {\r\n  BaiduMap, BmScale, BmMapType, BmNavigation, BmGeolocation, BmMarker, BmInfoWindow, BmLabel,\r\n  BmLocalSearch, BmControl, BmAutoComplete,\r\n} from 'vue-baidu-map/components'\r\n\r\nexport default {\r\n  name: 'GPS',\r\n  components: {\r\n    ARow,\r\n    PageLayout,\r\n    BaiduMap,\r\n    BmScale,\r\n    BmMapType,\r\n    BmNavigation,\r\n    BmGeolocation,\r\n    BmMarker,\r\n    BmInfoWindow,\r\n    BmLabel,\r\n    BmLocalSearch,\r\n    BmControl,\r\n    BmAutoComplete\r\n  },\r\n  props: {\r\n    visible: Boolean,\r\n    type: String,\r\n    record: Object,\r\n    id: Number\r\n    //center:Object\r\n  },\r\n  data () {\r\n    return {\r\n      form: this.$form.createForm(this),\r\n      show: false,\r\n      keyword: '',\r\n      zoom: 15,\r\n      status: {\r\n        loading: true\r\n      },\r\n      center: { lng: 122.1740, lat: 37.2512 },\r\n      layout: {\r\n        xs: { span: 24 },\r\n        sm: { span: 12 },\r\n        xl: { span: 6 }\r\n      },\r\n      projectCount: 0,\r\n      projectList: [],\r\n      mapList: null,\r\n      project_id: this.projectSelected().id,\r\n    }\r\n  },\r\n  mounted () {\r\n    this.getData()\r\n  },\r\n  methods: {\r\n    ...mapGetters(['projectSelected']),\r\n    getData () {\r\n      api.getMapList(this.project_id)\r\n        .then(data => {\r\n          this.mapList = data[0]\r\n          if (this.mapList != undefined) {\r\n            this.center.lng = this.mapList.longitude\r\n            this.center.lat = this.mapList.latitude\r\n          }\r\n        })\r\n    },\r\n    ...mapMutations(['SET_PROJECT']),\r\n    handler ({ BMap, map }) {\r\n    },\r\n    // addPoint(e) {\r\n    //   this.BMap.setMarker(e.point)\r\n    //   // let map = new BMap.Map()\r\n    //   // var point = new BMap.Point(e.point.lng,e.point.lat)\r\n    //   // var maker = new BMap.Marker(point)\r\n    //   // map.addOverlay(maker)\r\n    //   this.addMarker(marker)\r\n    //   alert(\"a\")\r\n    // },\r\n    infoWindowClose () {\r\n      this.show = false\r\n    },\r\n    infoWindowOpen () {\r\n      this.show = true\r\n    },\r\n    //地图点击\r\n    getClickInfo (e) {\r\n      this.center.lng = e.point.lng\r\n      this.center.lat = e.point.lat\r\n    },\r\n    syncCenterAndZoom (e) {\r\n      const { lng, lat } = e.target.getCenter()\r\n      this.center.lng = lng\r\n      this.center.lat = lat\r\n      this.zoom = e.target.getZoom()\r\n    },\r\n    /***\r\n     * 确认\r\n     */\r\n    // confirm: function () {\r\n    //   this.showMapComponent = false\r\n    //   this.$emit('map-confirm', this.center)\r\n    // },\r\n    handleOk () {\r\n      var temp={}\r\n      temp.longitude=this.center.lng\r\n      temp.latitude=this.center.lat\r\n      if(this.mapList!=undefined){\r\n        api.updateMapList(this.mapList.id, temp)\r\n        .then(data => {\r\n          this.$emit('close')\r\n          this.$notification.success({ message: '成功', description: '修改成功', key: 'SUCCESS' })\r\n          console.log(temp)\r\n        })\r\n      }\r\n      else{\r\n        api.createMapList(this.project_id, temp)\r\n        .then(data => {\r\n          this.$emit('close')\r\n          this.$notification.success({ message: '成功', description: '修改成功', key: 'SUCCESS' })\r\n          console.log(temp)\r\n        })\r\n        this.getData()\r\n      }\r\n\r\n    },\r\n    /***\r\n     * 取消\r\n     */\r\n    cancel: function () {\r\n      this.showMapComponent = false\r\n      this.$emit('cancel', this.showMapComponent)\r\n    },\r\n    // lngInit(center){\r\n    //   if(center.longitude){\r\n    //     return center.longitude\r\n    //   }\r\n    //   else{\r\n    //     return 116.404\r\n    //   }\r\n    // },\r\n    // latInit(center){\r\n    //   if(center.latitude){\r\n    //     return center.latitude\r\n    //   }\r\n    //   else{\r\n    //     return 39.915\r\n    //   }\r\n    // }\r\n  },\r\n  computed: {\r\n    project () {\r\n      return this.$store.getters.projectSelected\r\n    }\r\n\r\n  }\r\n}\r\n",{"version":3,"sources":["GPS.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"GPS.vue","sourceRoot":"src/views/detail","sourcesContent":["<template>\r\n  <div>\r\n    <div slot=\"footer\" style=\"margin-top: 0px;\">\r\n      <a-card>\r\n        <a-row :gutter=\"6\">\r\n          <a-col\r\n            class=\"item\"\r\n            :xs=\"{ span: 24 }\"\r\n            :sm=\"{ span: 8 , offset: 16 }\"\r\n            :xl=\"{ span: 4 , offset: 20 }\">\r\n            <a-button\r\n              style=\"float: right; margin-right: 10px\" @click=\"$router.go(-1)\">返回\r\n            </a-button>\r\n            <a-button type=\"primary\" style=\"float: right\" @click=\"handleOk\">保存</a-button>\r\n          </a-col>\r\n        </a-row>\r\n      </a-card>\r\n\r\n    </div>\r\n    <a-card style=\"margin-bottom: 16px;\">\r\n      <baidu-map class=\"map\" :center=\"center\" :zoom=\"zoom\" ak=\"GEhXNIBI6zKpsnemMOEVMxaUvSjQks3o\" @ready=\"handler\" @click=\"getClickInfo\"\r\n                 :scroll-wheel-zoom=\"true\" @moving=\"syncCenterAndZoom\" @moveend=\"syncCenterAndZoom\"\r\n                 @zoomend=\"syncCenterAndZoom\">\r\n        <bm-navigation anchor=\"BMAP_ANCHOR_TOP_RIGHT\"></bm-navigation>\r\n        <bm-geolocation anchor=\"BMAP_ANCHOR_BOTTOM_RIGHT\" :showAddressBar=\"true\"></bm-geolocation>\r\n        <bm-map-type :map-types=\"['BMAP_NORMAL_MAP', 'BMAP_HYBRID_MAP']\" anchor=\"BMAP_ANCHOR_BOTTOM_RIGHT\"\r\n                     offset=\"(300px,200px)\"></bm-map-type>\r\n        <bm-marker :position=\"{lng: center.lng, lat: center.lat}\" @click=\"infoWindowOpen\"\r\n                   animation=\"BMAP_ANIMATION_BOUNCE\">\r\n          <!--      <bm-label content=\"我爱北京天安门\" :labelStyle=\"{color: 'red', fontSize : '24px'}\" :offset=\"{width: -35, height: 30}\"/>-->\r\n          <bm-info-window :show=\"show\" @close=\"infoWindowClose\" @open=\"infoWindowOpen\">我爱北京天安门</bm-info-window>\r\n        </bm-marker>\r\n        <bm-control :offset=\"{width: '50px', height: '10px'}\">\r\n          <bm-auto-complete v-model=\"keyword\" :sugStyle=\"{zIndex: 1}\">\r\n            <a-input-search\r\n              placeholder=\"请输入文字\"\r\n              style=\"width: 200px\"\r\n            />\r\n          </bm-auto-complete>\r\n        </bm-control>\r\n        <bm-local-search :keyword=\"keyword\" :auto-viewport=\"true\"></bm-local-search>\r\n      </baidu-map>\r\n    </a-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapMutations } from 'vuex'\r\nimport { mapGetters } from 'vuex'\r\nimport router from '../../router'\r\nimport PageLayout from '../../components/page/PageLayout'\r\nimport api from '../../api/project'\r\nimport ARow from 'ant-design-vue/es/grid/Row'\r\nimport {\r\n  BaiduMap, BmScale, BmMapType, BmNavigation, BmGeolocation, BmMarker, BmInfoWindow, BmLabel,\r\n  BmLocalSearch, BmControl, BmAutoComplete,\r\n} from 'vue-baidu-map/components'\r\n\r\nexport default {\r\n  name: 'GPS',\r\n  components: {\r\n    ARow,\r\n    PageLayout,\r\n    BaiduMap,\r\n    BmScale,\r\n    BmMapType,\r\n    BmNavigation,\r\n    BmGeolocation,\r\n    BmMarker,\r\n    BmInfoWindow,\r\n    BmLabel,\r\n    BmLocalSearch,\r\n    BmControl,\r\n    BmAutoComplete\r\n  },\r\n  props: {\r\n    visible: Boolean,\r\n    type: String,\r\n    record: Object,\r\n    id: Number\r\n    //center:Object\r\n  },\r\n  data () {\r\n    return {\r\n      form: this.$form.createForm(this),\r\n      show: false,\r\n      keyword: '',\r\n      zoom: 15,\r\n      status: {\r\n        loading: true\r\n      },\r\n      center: { lng: 122.1740, lat: 37.2512 },\r\n      layout: {\r\n        xs: { span: 24 },\r\n        sm: { span: 12 },\r\n        xl: { span: 6 }\r\n      },\r\n      projectCount: 0,\r\n      projectList: [],\r\n      mapList: null,\r\n      project_id: this.projectSelected().id,\r\n    }\r\n  },\r\n  mounted () {\r\n    this.getData()\r\n  },\r\n  methods: {\r\n    ...mapGetters(['projectSelected']),\r\n    getData () {\r\n      api.getMapList(this.project_id)\r\n        .then(data => {\r\n          this.mapList = data[0]\r\n          if (this.mapList != undefined) {\r\n            this.center.lng = this.mapList.longitude\r\n            this.center.lat = this.mapList.latitude\r\n          }\r\n        })\r\n    },\r\n    ...mapMutations(['SET_PROJECT']),\r\n    handler ({ BMap, map }) {\r\n    },\r\n    // addPoint(e) {\r\n    //   this.BMap.setMarker(e.point)\r\n    //   // let map = new BMap.Map()\r\n    //   // var point = new BMap.Point(e.point.lng,e.point.lat)\r\n    //   // var maker = new BMap.Marker(point)\r\n    //   // map.addOverlay(maker)\r\n    //   this.addMarker(marker)\r\n    //   alert(\"a\")\r\n    // },\r\n    infoWindowClose () {\r\n      this.show = false\r\n    },\r\n    infoWindowOpen () {\r\n      this.show = true\r\n    },\r\n    //地图点击\r\n    getClickInfo (e) {\r\n      this.center.lng = e.point.lng\r\n      this.center.lat = e.point.lat\r\n    },\r\n    syncCenterAndZoom (e) {\r\n      const { lng, lat } = e.target.getCenter()\r\n      this.center.lng = lng\r\n      this.center.lat = lat\r\n      this.zoom = e.target.getZoom()\r\n    },\r\n    /***\r\n     * 确认\r\n     */\r\n    // confirm: function () {\r\n    //   this.showMapComponent = false\r\n    //   this.$emit('map-confirm', this.center)\r\n    // },\r\n    handleOk () {\r\n      var temp={}\r\n      temp.longitude=this.center.lng\r\n      temp.latitude=this.center.lat\r\n      if(this.mapList!=undefined){\r\n        api.updateMapList(this.mapList.id, temp)\r\n        .then(data => {\r\n          this.$emit('close')\r\n          this.$notification.success({ message: '成功', description: '修改成功', key: 'SUCCESS' })\r\n          console.log(temp)\r\n        })\r\n      }\r\n      else{\r\n        api.createMapList(this.project_id, temp)\r\n        .then(data => {\r\n          this.$emit('close')\r\n          this.$notification.success({ message: '成功', description: '修改成功', key: 'SUCCESS' })\r\n          console.log(temp)\r\n        })\r\n        this.getData()\r\n      }\r\n\r\n    },\r\n    /***\r\n     * 取消\r\n     */\r\n    cancel: function () {\r\n      this.showMapComponent = false\r\n      this.$emit('cancel', this.showMapComponent)\r\n    },\r\n    // lngInit(center){\r\n    //   if(center.longitude){\r\n    //     return center.longitude\r\n    //   }\r\n    //   else{\r\n    //     return 116.404\r\n    //   }\r\n    // },\r\n    // latInit(center){\r\n    //   if(center.latitude){\r\n    //     return center.latitude\r\n    //   }\r\n    //   else{\r\n    //     return 39.915\r\n    //   }\r\n    // }\r\n  },\r\n  computed: {\r\n    project () {\r\n      return this.$store.getters.projectSelected\r\n    }\r\n\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n  @import '~ant-design-vue/es/style/themes/default';\r\n\r\n  .map {\r\n    width: 100%;\r\n    height: 240px;\r\n  }\r\n\r\n</style>\r\n"]}]}