{"remainingRequest":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\ConstructionConsultationSystem\\Frontend\\src\\views\\project\\Project.vue?vue&type=style&index=0&id=8d48a7ec&lang=less&scoped=true&","dependencies":[{"path":"E:\\ConstructionConsultationSystem\\Frontend\\src\\views\\project\\Project.vue","mtime":1557660160400},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\less-loader\\dist\\cjs.js","mtime":1553685064192},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n@import '~ant-design-vue/es/style/themes/default';\n\n.project {\n  .tool {\n    .item {\n      margin-bottom: 16px;\n    }\n  }\n\n  .card {\n    margin-bottom: 16px;\n    border-radius: @border-radius-base;\n  }\n\n  .card-hover {\n    &:hover {\n      border-color: @primary-color;\n      box-shadow: 0 0 1px @primary-color;\n    }\n  }\n\n  .card-selected {\n    color: #fff;\n    background-color: @primary-color;\n    border-color: @primary-color;\n    box-shadow: 0 0 1px @primary-color;\n  }\n}\n",{"version":3,"sources":["Project.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0SA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Project.vue","sourceRoot":"src/views/project","sourcesContent":["<template>\r\n  <page-layout title=\"项目列表\">\r\n    <a-card class=\"project\">\r\n      <a-card\r\n        class=\"card card-selected\"\r\n        v-if=\"project\">\r\n        <project-card :project=\"project\"></project-card>\r\n      </a-card>\r\n      <a-card\r\n        class=\"card card-selected\"\r\n        style=\"text-align: center\"\r\n        v-else>\r\n        未选择项目\r\n      </a-card>\r\n      <a-input-group class=\"tool\">\r\n        <a-row :gutter=\"6\">\r\n          <a-col\r\n            class=\"item\"\r\n            :xs=\"{ span: 12 }\"\r\n            :sm=\"{ span: 8 }\"\r\n            :xl=\"{ span: 4 }\">\r\n            <a-select\r\n              v-model=\"params.ordering\"\r\n              style=\"width: 100%\"\r\n              @change=\"getData\">\r\n              <a-select-option value=\"starting_date\">开工时间正排序</a-select-option>\r\n              <a-select-option value=\"-starting_date\">开工时间倒排序</a-select-option>\r\n              <a-select-option value=\"finishing_date\">竣工时间正排序</a-select-option>\r\n              <a-select-option value=\"-finishing_date\">竣工时间倒排序</a-select-option>\r\n              <a-select-option value=\"investment\">项目投资正排序</a-select-option>\r\n              <a-select-option value=\"-investment\">项目投资倒排序</a-select-option>\r\n            </a-select>\r\n          </a-col>\r\n          <a-col\r\n            class=\"item\"\r\n            :xs=\"{ span: 12 }\"\r\n            :sm=\"{ span: 8 }\"\r\n            :xl=\"{ span: 4 }\">\r\n            <a-select\r\n              v-model=\"filter.investment\"\r\n              style=\"width: 100%\"\r\n              @change=\"handleFilterByInvestment\">\r\n              <a-select-option value=\"\">投资额筛选</a-select-option>\r\n              <a-select-option :value=\"1\">500万以下</a-select-option>\r\n              <a-select-option :value=\"2\">500万~1000万</a-select-option>\r\n              <a-select-option :value=\"3\">1000万~2000万</a-select-option>\r\n              <a-select-option :value=\"4\">2000万以上</a-select-option>\r\n            </a-select>\r\n          </a-col>\r\n          <a-col\r\n            class=\"item\"\r\n            :xs=\"{ span: 12 }\"\r\n            :sm=\"{ span: 8 }\"\r\n            :xl=\"{ span: 4 }\">\r\n            <a-select\r\n              v-model=\"filter.year\"\r\n              style=\"width: 100%\"\r\n              @change=\"handleFilterByYear\">\r\n              <a-select-option value=\"\">开工年份筛选</a-select-option>\r\n              <a-select-option v-for=\"(year, index) in yearList\" :key=\"index\" :value=\"index\">{{ year }}年\r\n              </a-select-option>\r\n              <a-select-option :value=\"4\">{{ yearList[yearList.length - 1] }}年之前</a-select-option>\r\n            </a-select>\r\n          </a-col>\r\n          <a-col\r\n            class=\"item\"\r\n            :xs=\"{ span: 24 }\"\r\n            :sm=\"{ span: 8 }\"\r\n            :xl=\"{ span: 4 }\">\r\n            <a-input\r\n              v-model=\"params.search\"\r\n              style=\"width: 100%\"\r\n              placeholder=\"项目名称，建设地点\">\r\n            </a-input>\r\n          </a-col>\r\n          <a-col\r\n            class=\"item\"\r\n            :xs=\"{ span: 12 }\"\r\n            :sm=\"{ span: 8 }\"\r\n            :xl=\"{ span: 4 }\">\r\n            <a-button\r\n              style=\"width: 100%\"\r\n              icon=\"search\"\r\n              @click=\"handleSearch\">\r\n              搜索\r\n            </a-button>\r\n          </a-col>\r\n          <a-col\r\n            class=\"item\"\r\n            :xs=\"{ span: 12 }\"\r\n            :sm=\"{ span: 8 }\"\r\n            :xl=\"{ span: 4 }\">\r\n            <a-button\r\n              style=\"width: 100%\"\r\n              icon=\"delete\"\r\n              @click=\"handleClearParams\">\r\n              重置\r\n            </a-button>\r\n          </a-col>\r\n        </a-row>\r\n        <a-row :gutter=\"6\">\r\n          <a-col\r\n            class=\"item\"\r\n            :xs=\"{ span: 24 }\"\r\n            :sm=\"{ span: 8 , offset: 16 }\"\r\n            :xl=\"{ span: 4 , offset: 20 }\"\r\n            v-action:add>\r\n            <a-button\r\n              type=\"primary\"\r\n              icon=\"plus\"\r\n              style=\"width: 100%\"\r\n              @click=\"$router.push({ name: 'projectCreate' })\">\r\n              新建项目\r\n            </a-button>\r\n          </a-col>\r\n        </a-row>\r\n      </a-input-group>\r\n      <a-spin :spinning=\"status.loading\">\r\n        <a-card\r\n          class=\"card\"\r\n          style=\"text-align: center\"\r\n          v-if=\"!projectCount\">\r\n          暂无数据\r\n        </a-card>\r\n        <a-card\r\n          class=\"card card-hover\"\r\n          v-for=\"project in projectList\"\r\n          :key=\"project.id\"\r\n          @click=\"handleProjectSelect(project)\">\r\n          <project-card :project=\"project\"></project-card>\r\n        </a-card>\r\n      </a-spin>\r\n      <a-pagination\r\n        v-model=\"params.page\"\r\n        :defaultPageSize=\"10\"\r\n        @change=\"handelePage\"\r\n        style=\"float: right\"\r\n        :total=\"projectCount\">\r\n      </a-pagination>\r\n      <div style=\"margin: 0 20px 10px 0;\">共 {{ this.projectCount }} 个</div>\r\n    </a-card>\r\n  </page-layout>\r\n</template>\r\n\r\n<script>\r\n  import { mapMutations } from 'vuex'\r\n  import router from '../../router'\r\n  import PageLayout from '../../components/page/PageLayout'\r\n  import ProjectCard from './components/Card'\r\n  import api from '../../api/project'\r\n  import ARow from 'ant-design-vue/es/grid/Row'\r\n\r\n  export default {\r\n    name: 'Project',\r\n    components: {\r\n      ARow,\r\n      PageLayout,\r\n      ProjectCard\r\n    },\r\n    data () {\r\n      return {\r\n        params: {\r\n          min_investment: '',\r\n          max_investment: '',\r\n          min_date: '',\r\n          max_date: '',\r\n          search: '',\r\n          page: 1,\r\n          ordering: '-starting_date'\r\n        },\r\n        filter: {\r\n          investment: '',\r\n          year: ''\r\n        },\r\n        status: {\r\n          loading: true\r\n        },\r\n        projectCount: 0,\r\n        projectList: []\r\n      }\r\n    },\r\n    mounted () {\r\n      this.getData()\r\n    },\r\n    methods: {\r\n      ...mapMutations(['SET_PROJECT']),\r\n      getData () {\r\n        this.status.loading = true\r\n        api.getProjectList(this.params)\r\n          .then(data => {\r\n            this.projectList = data.results\r\n            this.projectCount = data.count\r\n            this.status.loading = false\r\n          })\r\n      },\r\n      handelePage (page) {\r\n        this.params.page = page\r\n        this.getData()\r\n      },\r\n      handleFilterByInvestment (value) {\r\n        switch (value) {\r\n          case 1:\r\n            this.params.min_investment = ''\r\n            this.params.max_investment = '500'\r\n            break\r\n          case 2:\r\n            this.params.min_investment = '500'\r\n            this.params.max_investment = '1000'\r\n            break\r\n          case 3:\r\n            this.params.min_investment = '1000'\r\n            this.params.max_investment = '2000'\r\n            break\r\n          case 4:\r\n            this.params.min_investment = '2000'\r\n            this.params.max_investment = ''\r\n            break\r\n          default:\r\n            this.params.min_investment = ''\r\n            this.params.max_investment = ''\r\n            this.filter.investment = ''\r\n            break\r\n        }\r\n        this.getData()\r\n      },\r\n      handleFilterByYear (value) {\r\n        switch (value) {\r\n          case 0:\r\n            this.params.min_date = this.yearList[0] + '-01-01'\r\n            this.params.max_date = this.yearList[0] + '-12-31'\r\n            break\r\n          case 1:\r\n            this.params.min_date = this.yearList[1] + '-01-01'\r\n            this.params.max_date = this.yearList[1] + '-12-31'\r\n            break\r\n          case 2:\r\n            this.params.min_date = this.yearList[2] + '-01-01'\r\n            this.params.max_date = this.yearList[2] + '-12-31'\r\n            break\r\n          case 3:\r\n            this.params.min_date = this.yearList[3] + '-01-01'\r\n            this.params.max_date = this.yearList[3] + '-12-31'\r\n            break\r\n          case 4:\r\n            this.params.max_date = this.yearList[3] + '-12-31'\r\n            break\r\n          default:\r\n            this.params.min_date = ''\r\n            this.params.max_date = ''\r\n            this.filter.year = ''\r\n            break\r\n        }\r\n        this.getData()\r\n      },\r\n      handleSearch () {\r\n        this.getData()\r\n      },\r\n      handleClearParams () {\r\n        this.filter.investment = ''\r\n        this.filter.year = ''\r\n        this.params.ordering = 'starting_date'\r\n        this.params.min_investment = ''\r\n        this.params.max_investment = ''\r\n        this.params.min_date = ''\r\n        this.params.max_date = ''\r\n        this.params.search = ''\r\n        this.params.page = 1\r\n        this.getData()\r\n      },\r\n      handleProjectSelect (project) {\r\n        this.SET_PROJECT(project)\r\n        const role = this.$store.getters.role\r\n        if (role.permissionList.indexOf('project_selected') === -1) {\r\n          role.permissionList.push('project_selected')\r\n        }\r\n        this.$store.commit('SET_ROLE', role)\r\n        this.$store.dispatch('GenerateRoutes', { roles: role })\r\n        router.addRoutes(this.$store.getters.addRouters)\r\n        router.push({ name: 'detail' })\r\n      }\r\n    },\r\n    computed: {\r\n      project () {\r\n        return this.$store.getters.projectSelected\r\n      },\r\n      yearList () {\r\n        const ret = []\r\n        const year = (new Date()).getFullYear()\r\n        for (let i = 0; i < 4; i++) {\r\n          ret.push(year - i)\r\n        }\r\n        return ret\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n  @import '~ant-design-vue/es/style/themes/default';\r\n\r\n  .project {\r\n    .tool {\r\n      .item {\r\n        margin-bottom: 16px;\r\n      }\r\n    }\r\n\r\n    .card {\r\n      margin-bottom: 16px;\r\n      border-radius: @border-radius-base;\r\n    }\r\n\r\n    .card-hover {\r\n      &:hover {\r\n        border-color: @primary-color;\r\n        box-shadow: 0 0 1px @primary-color;\r\n      }\r\n    }\r\n\r\n    .card-selected {\r\n      color: #fff;\r\n      background-color: @primary-color;\r\n      border-color: @primary-color;\r\n      box-shadow: 0 0 1px @primary-color;\r\n    }\r\n  }\r\n</style>\r\n"]}]}