{"remainingRequest":"E:\\FoodProductManagementSystem\\Frontend\\node_modules\\babel-loader\\lib\\index.js!E:\\FoodProductManagementSystem\\Frontend\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\FoodProductManagementSystem\\Frontend\\src\\store\\modules\\permission.js","dependencies":[{"path":"E:\\FoodProductManagementSystem\\Frontend\\src\\store\\modules\\permission.js","mtime":1553931799903},{"path":"E:\\FoodProductManagementSystem\\Frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\FoodProductManagementSystem\\Frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\FoodProductManagementSystem\\Frontend\\node_modules\\eslint-loader\\index.js","mtime":1575333166264}],"contextDependencies":[],"result":["import _Promise from \"E:\\\\FoodProductManagementSystem\\\\Frontend\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/promise\";\nimport _toConsumableArray from \"E:\\\\FoodProductManagementSystem\\\\Frontend\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/toConsumableArray\";\nimport { asyncRouterMap, constantRouterMap } from '@/config/router.config';\nimport _ from 'lodash';\n/**\r\n * 过滤账户是否拥有某一个权限，并将菜单从加载列表移除\r\n *\r\n * @param permissionList\r\n * @param route\r\n * @returns {boolean}\r\n */\n\nfunction hasPermission(permissionList, route) {\n  var ret = true;\n\n  if (route.meta && route.meta.permission) {\n    route.meta.permission.forEach(function (permission) {\n      if (permissionList.indexOf(permission) === -1) {\n        ret = false;\n      }\n    });\n  }\n\n  return ret;\n}\n\nfunction filterAsyncRouter(routerMap, roles) {\n  return routerMap.filter(function (route) {\n    if (hasPermission(roles.permissionList, route)) {\n      if (route.children && route.children.length) {\n        route.children = filterAsyncRouter(route.children, roles);\n      }\n\n      return true;\n    }\n\n    return false;\n  });\n}\n\nvar permission = {\n  state: {\n    routers: constantRouterMap,\n    addRouters: []\n  },\n  mutations: {\n    SET_ROUTERS: function SET_ROUTERS(state, addRouters) {\n      var _state$routers;\n\n      (_state$routers = state.routers).push.apply(_state$routers, _toConsumableArray(addRouters));\n\n      state.addRouters = addRouters;\n    }\n  },\n  actions: {\n    GenerateRoutes: function GenerateRoutes(_ref, data) {\n      var commit = _ref.commit,\n          state = _ref.state;\n      return new _Promise(function (resolve) {\n        var roles = data.roles;\n        var accessedRouters = filterAsyncRouter(_.cloneDeep(asyncRouterMap), roles);\n        commit('SET_ROUTERS', accessedRouters);\n        resolve();\n      });\n    }\n  }\n};\nexport default permission;",{"version":3,"sources":["E:\\FoodProductManagementSystem\\Frontend\\src\\store\\modules\\permission.js"],"names":["asyncRouterMap","constantRouterMap","_","hasPermission","permissionList","route","ret","meta","permission","forEach","indexOf","filterAsyncRouter","routerMap","roles","filter","children","length","state","routers","addRouters","mutations","SET_ROUTERS","push","actions","GenerateRoutes","data","commit","resolve","accessedRouters","cloneDeep"],"mappings":";;AAAA,SAASA,cAAT,EAAyBC,iBAAzB,QAAkD,wBAAlD;AACA,OAAOC,CAAP,MAAc,QAAd;AAEA;;;;;;;;AAOA,SAASC,aAAT,CAAwBC,cAAxB,EAAwCC,KAAxC,EAA+C;AAC7C,MAAIC,GAAG,GAAG,IAAV;;AACA,MAAID,KAAK,CAACE,IAAN,IAAcF,KAAK,CAACE,IAAN,CAAWC,UAA7B,EAAyC;AACvCH,IAAAA,KAAK,CAACE,IAAN,CAAWC,UAAX,CAAsBC,OAAtB,CAA8B,UAAAD,UAAU,EAAI;AAC1C,UAAIJ,cAAc,CAACM,OAAf,CAAuBF,UAAvB,MAAuC,CAAC,CAA5C,EAA+C;AAC7CF,QAAAA,GAAG,GAAG,KAAN;AACD;AACF,KAJD;AAKD;;AACD,SAAOA,GAAP;AACD;;AAED,SAASK,iBAAT,CAA4BC,SAA5B,EAAuCC,KAAvC,EAA8C;AAC5C,SAAOD,SAAS,CAACE,MAAV,CAAiB,UAAAT,KAAK,EAAI;AAC/B,QAAIF,aAAa,CAACU,KAAK,CAACT,cAAP,EAAuBC,KAAvB,CAAjB,EAAgD;AAC9C,UAAIA,KAAK,CAACU,QAAN,IAAkBV,KAAK,CAACU,QAAN,CAAeC,MAArC,EAA6C;AAC3CX,QAAAA,KAAK,CAACU,QAAN,GAAiBJ,iBAAiB,CAACN,KAAK,CAACU,QAAP,EAAiBF,KAAjB,CAAlC;AACD;;AACD,aAAO,IAAP;AACD;;AACD,WAAO,KAAP;AACD,GARM,CAAP;AASD;;AAED,IAAML,UAAU,GAAG;AACjBS,EAAAA,KAAK,EAAE;AACLC,IAAAA,OAAO,EAAEjB,iBADJ;AAELkB,IAAAA,UAAU,EAAE;AAFP,GADU;AAKjBC,EAAAA,SAAS,EAAE;AACTC,IAAAA,WAAW,EAAE,qBAACJ,KAAD,EAAQE,UAAR,EAAuB;AAAA;;AAClC,wBAAAF,KAAK,CAACC,OAAN,EAAcI,IAAd,0CAAsBH,UAAtB;;AACAF,MAAAA,KAAK,CAACE,UAAN,GAAmBA,UAAnB;AACD;AAJQ,GALM;AAWjBI,EAAAA,OAAO,EAAE;AACPC,IAAAA,cADO,gCAC4BC,IAD5B,EACkC;AAAA,UAAvBC,MAAuB,QAAvBA,MAAuB;AAAA,UAAfT,KAAe,QAAfA,KAAe;AACvC,aAAO,aAAY,UAAAU,OAAO,EAAI;AAAA,YACpBd,KADoB,GACVY,IADU,CACpBZ,KADoB;AAE5B,YAAMe,eAAe,GAAGjB,iBAAiB,CAACT,CAAC,CAAC2B,SAAF,CAAY7B,cAAZ,CAAD,EAA8Ba,KAA9B,CAAzC;AACAa,QAAAA,MAAM,CAAC,aAAD,EAAgBE,eAAhB,CAAN;AACAD,QAAAA,OAAO;AACR,OALM,CAAP;AAMD;AARM;AAXQ,CAAnB;AAuBA,eAAenB,UAAf","sourcesContent":["import { asyncRouterMap, constantRouterMap } from '@/config/router.config'\r\nimport _ from 'lodash'\r\n\r\n/**\r\n * 过滤账户是否拥有某一个权限，并将菜单从加载列表移除\r\n *\r\n * @param permissionList\r\n * @param route\r\n * @returns {boolean}\r\n */\r\nfunction hasPermission (permissionList, route) {\r\n  let ret = true\r\n  if (route.meta && route.meta.permission) {\r\n    route.meta.permission.forEach(permission => {\r\n      if (permissionList.indexOf(permission) === -1) {\r\n        ret = false\r\n      }\r\n    })\r\n  }\r\n  return ret\r\n}\r\n\r\nfunction filterAsyncRouter (routerMap, roles) {\r\n  return routerMap.filter(route => {\r\n    if (hasPermission(roles.permissionList, route)) {\r\n      if (route.children && route.children.length) {\r\n        route.children = filterAsyncRouter(route.children, roles)\r\n      }\r\n      return true\r\n    }\r\n    return false\r\n  })\r\n}\r\n\r\nconst permission = {\r\n  state: {\r\n    routers: constantRouterMap,\r\n    addRouters: []\r\n  },\r\n  mutations: {\r\n    SET_ROUTERS: (state, addRouters) => {\r\n      state.routers.push(...addRouters)\r\n      state.addRouters = addRouters\r\n    }\r\n  },\r\n  actions: {\r\n    GenerateRoutes ({ commit, state }, data) {\r\n      return new Promise(resolve => {\r\n        const { roles } = data\r\n        const accessedRouters = filterAsyncRouter(_.cloneDeep(asyncRouterMap), roles)\r\n        commit('SET_ROUTERS', accessedRouters)\r\n        resolve()\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\nexport default permission\r\n"]}]}