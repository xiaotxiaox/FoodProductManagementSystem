{"remainingRequest":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\babel-loader\\lib\\index.js!E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\ConstructionConsultationSystem\\Frontend\\src\\components\\baidu-map.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\ConstructionConsultationSystem\\Frontend\\src\\components\\baidu-map.vue","mtime":1569586185067},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _parseFloat from \"E:\\\\ConstructionConsultationSystem\\\\Frontend\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/parse-float\";\nimport _typeof from \"E:\\\\ConstructionConsultationSystem\\\\Frontend\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/typeof\";\nimport _Promise from \"E:\\\\ConstructionConsultationSystem\\\\Frontend\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/promise\";\nimport \"core-js/modules/es6.number.constructor\";\n//\n//\n//\nexport default {\n  props: {\n    zoom: {\n      type: Number,\n      default: 15\n    },\n    center: {\n      type: [Object, String],\n      default: function _default() {\n        return {\n          lng: 116.404,\n          lat: 39.915\n        };\n      }\n    },\n    marker: {\n      type: [Object, String],\n      default: function _default() {\n        return {\n          lng: 116.404,\n          lat: 39.915\n        };\n      }\n    },\n    search: ''\n  },\n  data: function data() {\n    return {\n      ak: 'okFNZHPQ0BfF9Qhq3K1WmrRv',\n      BMap: {},\n      map: {},\n      currentPosition: null\n    };\n  },\n  methods: {\n    init: function init(BMap) {\n      var $el = this.$refs.map;\n      var map = new BMap.Map($el);\n      this.map = map; // 初始化中心位置\n\n      var getCenterPoint = this.getCenterPoint,\n          zoom = this.zoom;\n      map.centerAndZoom(getCenterPoint(), zoom || 15);\n      this.setMarker(this.marker);\n      this.$emit('ready', {\n        BMap: BMap,\n        map: map\n      });\n    },\n    // 初始化地图\n    initMap: function initMap(BMap) {\n      this.BMap = BMap;\n      this.init(BMap);\n    },\n    // 加载百度地图API\n    getMapScript: function getMapScript() {\n      if (!global.BMap) {\n        var ak = this.ak || this._BMap().ak;\n\n        global.BMap = {};\n        global.BMap._preloader = new _Promise(function (resolve, reject) {\n          global._initBaiduMap = function () {\n            resolve(global.BMap);\n            global.document.body.removeChild($script);\n            global.BMap._preloader = null;\n            global._initBaiduMap = null;\n          };\n\n          var $script = document.createElement('script');\n          global.document.body.appendChild($script);\n          $script.src = \"//api.map.baidu.com/api?v=2.0&ak=\".concat(ak, \"&callback=_initBaiduMap\");\n        });\n        return global.BMap._preloader;\n      } else if (!global.BMap._preloader) {\n        return _Promise.resolve(global.BMap);\n      } else {\n        return global.BMap._preloader;\n      }\n    },\n    // 地图中心点\n    getCenterPoint: function getCenterPoint() {\n      var center = this.center,\n          BMap = this.BMap;\n\n      switch (_typeof(center)) {\n        case 'string':\n          return center;\n\n        case 'object':\n          return new BMap.Point(_parseFloat(center.lng), _parseFloat(center.lat));\n\n        default:\n          return new BMap.Point(116.404, 39.915);\n      }\n    },\n    // 设置中心点\n    setCenter: function setCenter() {\n      var map = this.map,\n          getCenterPoint = this.getCenterPoint;\n      map.setCenter(getCenterPoint());\n    },\n    // 设置Marker\n    setMarker: function setMarker(p) {\n      var _this2 = this;\n\n      var map = this.map,\n          BMap = this.BMap;\n      map.clearOverlays(); // 清除地图上所有覆盖物\n\n      var marker = new BMap.Marker(new BMap.Point(_parseFloat(p.lng), _parseFloat(p.lat))); // 创建标注\n\n      map.addOverlay(marker); // 将标注添加到地图中\n\n      marker.enableDragging(); // 可拖拽\n\n      marker.addEventListener('dragend', function () {\n        var p = marker.getPosition();\n        _this2.currentValue = {\n          lng: p.lng,\n          lat: p.lat\n        };\n      });\n    },\n    // 获取当前坐标\n    getCurrentPosition: function getCurrentPosition(callback) {\n      var BMap = this.BMap;\n\n      var _this = this;\n\n      var geolocation = new BMap.Geolocation();\n      geolocation.getCurrentPosition(function (r) {\n        if (this.getStatus() === global.BMAP_STATUS_SUCCESS) {\n          _this.currentPosition = r.point;\n          callback(r);\n        } else {\n          callback(false);\n        }\n      }, {\n        enableHighAccuracy: true\n      });\n    },\n    // 初始化附近\n    initNearby: function initNearby(callback) {\n      var BMap = this.BMap,\n          currentPosition = this.currentPosition,\n          getCurrentPosition = this.getCurrentPosition;\n      var geoc = new BMap.Geocoder();\n\n      if (!currentPosition) {\n        getCurrentPosition(function (response) {\n          var point = new BMap.Point(_parseFloat(response.point.lng), _parseFloat(response.point.lat));\n          geoc.getLocation(point, function (results) {\n            callback(results.surroundingPois);\n          }, {\n            poiRadius: 10 * 1000,\n            numPois: 10\n          });\n        });\n      } else {\n        var point = new BMap.Point(_parseFloat(currentPosition.lng), _parseFloat(currentPosition.lat));\n        geoc.getLocation(point, function (results) {\n          callback(results);\n        });\n      }\n    },\n    // 获取周边信息\n    searchNearby: function searchNearby(key, callback) {\n      var BMap = this.BMap,\n          map = this.map,\n          currentPosition = this.currentPosition,\n          getCurrentPosition = this.getCurrentPosition;\n      var options = {\n        onSearchComplete: function onSearchComplete(results) {\n          if (local.getStatus() === global.BMAP_STATUS_SUCCESS) {\n            var rel = [];\n\n            for (var i = 0; i < results.getCurrentNumPois(); i++) {\n              rel.push(results.getPoi(i));\n            }\n\n            callback(rel);\n          }\n        }\n      };\n      var local = new BMap.LocalSearch(map, options);\n\n      if (!currentPosition) {\n        getCurrentPosition(function (response) {\n          var point = new BMap.Point(_parseFloat(response.point.lng), _parseFloat(response.point.lat));\n          local.searchNearby(key, point, 20 * 1000);\n        });\n      } else {\n        var point = new BMap.Point(_parseFloat(currentPosition.lng), _parseFloat(currentPosition.lat));\n        local.searchNearby(key, point, 20 * 1000);\n      }\n    }\n  },\n  created: function created() {\n    var getMapScript = this.getMapScript,\n        initMap = this.initMap;\n    getMapScript().then(initMap); // 加载地图接口，并初始化地图\n  }\n};",{"version":3,"sources":["baidu-map.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div ref=\"map\" class=\"baidu-map\"></div>\r\n</template>\r\n<script>\r\nexport default {\r\n  props: {\r\n    zoom: {\r\n      type: Number,\r\n      default: 15\r\n    },\r\n    center: {\r\n      type: [Object, String],\r\n      default () {\r\n        return {lng: 116.404, lat: 39.915}\r\n      }\r\n    },\r\n    marker: {\r\n      type: [Object, String],\r\n      default () {\r\n        return {lng: 116.404, lat: 39.915}\r\n      }\r\n    },\r\n    search: ''\r\n  },\r\n  data: () => ({\r\n    ak: 'okFNZHPQ0BfF9Qhq3K1WmrRv',\r\n    BMap: {},\r\n    map: {},\r\n    currentPosition: null\r\n  }),\r\n  methods: {\r\n    init (BMap) {\r\n      let $el = this.$refs.map\r\n      const map = new BMap.Map($el)\r\n      this.map = map\r\n\r\n      // 初始化中心位置\r\n      const {getCenterPoint, zoom} = this\r\n      map.centerAndZoom(getCenterPoint(), zoom || 15)\r\n\r\n      this.setMarker(this.marker)\r\n      this.$emit('ready', {BMap, map})\r\n    },\r\n\r\n    // 初始化地图\r\n    initMap (BMap) {\r\n      this.BMap = BMap\r\n      this.init(BMap)\r\n    },\r\n\r\n    // 加载百度地图API\r\n    getMapScript () {\r\n      if (!global.BMap) {\r\n        const ak = this.ak || this._BMap().ak\r\n        global.BMap = {}\r\n        global.BMap._preloader = new Promise((resolve, reject) => {\r\n          global._initBaiduMap = function () {\r\n            resolve(global.BMap)\r\n            global.document.body.removeChild($script)\r\n            global.BMap._preloader = null\r\n            global._initBaiduMap = null\r\n          }\r\n          const $script = document.createElement('script')\r\n          global.document.body.appendChild($script)\r\n          $script.src = `//api.map.baidu.com/api?v=2.0&ak=${ak}&callback=_initBaiduMap`\r\n        })\r\n        return global.BMap._preloader\r\n      } else if (!global.BMap._preloader) {\r\n        return Promise.resolve(global.BMap)\r\n      } else {\r\n        return global.BMap._preloader\r\n      }\r\n    },\r\n\r\n    // 地图中心点\r\n    getCenterPoint () {\r\n      const {center, BMap} = this\r\n      switch (typeof center) {\r\n        case 'string':\r\n          return center\r\n        case 'object':\r\n          return new BMap.Point(parseFloat(center.lng), parseFloat(center.lat))\r\n        default: return new BMap.Point(116.404, 39.915)\r\n      }\r\n    },\r\n\r\n    // 设置中心点\r\n    setCenter () {\r\n      const {map, getCenterPoint} = this\r\n      map.setCenter(getCenterPoint())\r\n    },\r\n\r\n    // 设置Marker\r\n    setMarker (p) {\r\n      const {map, BMap} = this\r\n      map.clearOverlays() // 清除地图上所有覆盖物\r\n      const marker = new BMap.Marker(new BMap.Point(parseFloat(p.lng), parseFloat(p.lat))) // 创建标注\r\n      map.addOverlay(marker) // 将标注添加到地图中\r\n      marker.enableDragging() // 可拖拽\r\n      marker.addEventListener('dragend', () => {\r\n        var p = marker.getPosition()\r\n        this.currentValue = {\r\n          lng: p.lng,\r\n          lat: p.lat\r\n        }\r\n      })\r\n    },\r\n\r\n\r\n    // 获取当前坐标\r\n    getCurrentPosition (callback) {\r\n      const { BMap } = this\r\n      var _this = this\r\n      let geolocation = new BMap.Geolocation()\r\n      geolocation.getCurrentPosition(function (r) {\r\n        if (this.getStatus() === global.BMAP_STATUS_SUCCESS) {\r\n          _this.currentPosition = r.point\r\n          callback(r)\r\n        } else {\r\n          callback(false)\r\n        }\r\n      }, {enableHighAccuracy: true})\r\n    },\r\n\r\n    // 初始化附近\r\n    initNearby (callback) {\r\n      const { BMap, currentPosition, getCurrentPosition } = this\r\n      var geoc = new BMap.Geocoder()\r\n\r\n      if (!currentPosition) {\r\n        getCurrentPosition(response => {\r\n          let point = new BMap.Point(parseFloat(response.point.lng), parseFloat(response.point.lat))\r\n          geoc.getLocation(point, function (results) {\r\n            callback(results.surroundingPois)\r\n          }, {\r\n            poiRadius: 10 * 1000,\r\n            numPois: 10\r\n          })\r\n        })\r\n      } else {\r\n        let point = new BMap.Point(parseFloat(currentPosition.lng), parseFloat(currentPosition.lat))\r\n        geoc.getLocation(point, function (results) {\r\n          callback(results)\r\n        })\r\n      }\r\n    },\r\n\r\n    // 获取周边信息\r\n    searchNearby (key, callback) {\r\n      const { BMap, map, currentPosition, getCurrentPosition } = this\r\n      var options = {\r\n        onSearchComplete: results => {\r\n          if (local.getStatus() === global.BMAP_STATUS_SUCCESS) {\r\n            var rel = []\r\n            for (var i = 0; i < results.getCurrentNumPois(); i++) {\r\n              rel.push(results.getPoi(i))\r\n            }\r\n            callback(rel)\r\n          }\r\n        }\r\n      }\r\n      var local = new BMap.LocalSearch(map, options)\r\n\r\n      if (!currentPosition) {\r\n        getCurrentPosition(response => {\r\n          let point = new BMap.Point(parseFloat(response.point.lng), parseFloat(response.point.lat))\r\n          local.searchNearby(key, point, 20 * 1000)\r\n        })\r\n      } else {\r\n        let point = new BMap.Point(parseFloat(currentPosition.lng), parseFloat(currentPosition.lat))\r\n        local.searchNearby(key, point, 20 * 1000)\r\n      }\r\n    }\r\n  },\r\n  created () {\r\n    const {getMapScript, initMap} = this\r\n    getMapScript().then(initMap) // 加载地图接口，并初始化地图\r\n  }\r\n}\r\n\r\n</script>\r\n<style>\r\n.baidu-map {\r\n  width: 100%;\r\n  height: 500px;\r\n  border: 1px solid #eee;\r\n}\r\n</style>\r\n\r\n\r\n"],"sourceRoot":"src/components"}]}