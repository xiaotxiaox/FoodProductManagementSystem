{"remainingRequest":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\babel-loader\\lib\\index.js!E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\ConstructionConsultationSystem\\Frontend\\src\\views\\detail\\DetailEdit.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\ConstructionConsultationSystem\\Frontend\\src\\views\\detail\\DetailEdit.vue","mtime":1557326111208},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ConstructionConsultationSystem\\Frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectSpread from \"E:\\\\ConstructionConsultationSystem\\\\Frontend\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport projectApi from '../../api/project';\nimport detailApi from '../../api/detail';\nimport moment from 'moment';\nimport { mapGetters } from 'vuex';\nexport default {\n  name: 'DetailEdit',\n  data: function data() {\n    return {\n      form: this.$form.createForm(this),\n      scaleList: [],\n      propertyList: [],\n      purposeList: [],\n      fundSourcesList: [],\n      styleList: [],\n      project: null\n    };\n  },\n  mounted: function mounted() {\n    var _this = this;\n\n    this.getProjectDetail();\n    projectApi.getScaleList().then(function (data) {\n      _this.scaleList = data;\n    });\n    projectApi.getPropertyList().then(function (data) {\n      _this.propertyList = data;\n    });\n    projectApi.getPurposeList().then(function (data) {\n      _this.purposeList = data;\n    });\n    projectApi.getFundSourcesList().then(function (data) {\n      _this.fundSourcesList = data;\n    });\n    projectApi.getStyleList().then(function (data) {\n      _this.styleList = data;\n    });\n  },\n  methods: _objectSpread({}, mapGetters(['projectSelected']), {\n    getProjectDetail: function getProjectDetail() {\n      var _this2 = this;\n\n      detailApi.getProjectDetail(this.projectSelected().id).then(function (data) {\n        // 处理获得的数据\n        data.scale = data.scale.value;\n        data.style = data.style.map(function (value) {\n          return value.value;\n        });\n        data.property = data.property.map(function (value) {\n          return value.value;\n        });\n        data.purpose = data.purpose.map(function (value) {\n          return value.value;\n        });\n        data.fund_sources = data.fund_sources.map(function (value) {\n          return value.value;\n        });\n        data.starting_date = new moment(data.starting_date);\n        data.finishing_date = new moment(data.finishing_date);\n        _this2.project = data;\n      });\n    },\n    handleSubmit: function handleSubmit(e) {\n      var _this3 = this;\n\n      e.preventDefault();\n      this.form.validateFields(function (error, data) {\n        if (!error) {\n          data.starting_date = data.starting_date.format('YYYY-MM-DD');\n          data.finishing_date = data.finishing_date.format('YYYY-MM-DD');\n          detailApi.updateProject(data).then(function (data) {\n            _this3.$notification.success({\n              message: '成功',\n              description: '修改成功',\n              key: 'SUCCESS'\n            });\n\n            _this3.$router.push({\n              name: 'detail'\n            });\n          });\n        }\n      });\n    },\n    handelDelete: function handelDelete() {\n      this.$confirm({\n        title: '此操作不可逆，请再次确定是否删除项目。',\n        okText: '删除',\n        okType: 'danger',\n        onOk: function onOk() {\n          console.log('deleted');\n        }\n      });\n    },\n    validateID: function validateID(rule, value, callback) {\n      projectApi.validateID(value).then(function (data) {\n        if (data.result === '此项目编号已被使用！') {\n          callback(data.result);\n        } else {\n          callback();\n        }\n      });\n    }\n  })\n};",{"version":3,"sources":["DetailEdit.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <a-card>\r\n    <a-col\r\n      class=\"item\"\r\n      :xs=\"{span: 24}\"\r\n      :sm=\"{span: 20}\"\r\n      :xl=\"{span: 16}\">\r\n      <a-form\r\n        :form=\"form\"\r\n        @submit=\"handleSubmit\">\r\n        <!--          <a-form-item-->\r\n        <!--            label=\"项目图片\"-->\r\n        <!--            :label-col=\"{span: 6}\"-->\r\n        <!--            :wrapper-col=\"{span: 18}\">-->\r\n        <!--            <a-upload-->\r\n        <!--              name=\"avatar\"-->\r\n        <!--              listType=\"picture-card\"-->\r\n        <!--              class=\"avatar-uploader\"-->\r\n        <!--              :showUploadList=\"false\"-->\r\n        <!--              action=\"//jsonplaceholder.typicode.com/posts/\"-->\r\n        <!--              :beforeUpload=\"beforeUpload\"-->\r\n        <!--              @change=\"handleImageChange\"-->\r\n        <!--              v-decorator=\"['image']\">-->\r\n        <!--              <img v-if=\"imageUrl\" :src=\"imageUrl\" alt=\"avatar\"/>-->\r\n        <!--              <div v-else>-->\r\n        <!--                <a-icon :type=\"loading ? 'loading' : 'plus'\"/>-->\r\n        <!--                <div class=\"ant-upload-text\">上传项目图片</div>-->\r\n        <!--              </div>-->\r\n        <!--            </a-upload>-->\r\n        <!--          </a-form-item>-->\r\n        <a-form-item\r\n          label=\"项目编号\"\r\n          :label-col=\"{span: 6}\"\r\n          :wrapper-col=\"{span: 18}\">\r\n          <a-input\r\n            disabled\r\n            type=\"text\"\r\n            v-decorator=\"['id', {initialValue: project ? project.id : null}]\">\r\n          </a-input>\r\n        </a-form-item>\r\n        <a-form-item\r\n          label=\"项目名称\"\r\n          :label-col=\"{span: 6}\"\r\n          :wrapper-col=\"{span: 18}\">\r\n          <a-input\r\n            type=\"text\"\r\n            autocomplete=\"true\"\r\n            placeholder=\"XXX项目\"\r\n            v-decorator=\"[\r\n              'name',\r\n              {rules:[\r\n                 {required: true, message: '请输入项目名称'},\r\n                 {max:256, message:'长度在256个汉字以内'}\r\n               ],\r\n               validateTrigger: 'blur',\r\n               initialValue: project ? project.name : null\r\n              }]\">\r\n          </a-input>\r\n        </a-form-item>\r\n        <a-form-item\r\n          label=\"工程概况规模\"\r\n          :label-col=\"{span: 6}\"\r\n          :wrapper-col=\"{span: 18}\">\r\n          <a-select\r\n            placeholder=\"请选择工程概况规模\"\r\n            v-decorator=\"[\r\n              'scale',\r\n              {rules: [{required: true, message: '请选择工程规模'}],\r\n               initialValue: project ? project.scale : null}\r\n            ]\">\r\n            <a-select-option\r\n              v-for=\"item in scaleList\"\r\n              :key=\"item.value\"\r\n              :value=\"item.value\">\r\n              {{ item.label }}\r\n            </a-select-option>\r\n          </a-select>\r\n        </a-form-item>\r\n        <a-form-item\r\n          label=\"性质\"\r\n          :label-col=\"{span: 6}\"\r\n          :wrapper-col=\"{span: 18}\">\r\n          <a-select\r\n            mode=\"multiple\"\r\n            placeholder=\"请选择工程性质\"\r\n            v-decorator=\"[\r\n              'property',\r\n              {rules: [{required: true, message: '请选择性质'}],\r\n               initialValue: project ? project.property : null}\r\n            ]\">\r\n            <a-select-option\r\n              v-for=\"item in propertyList\"\r\n              :key=\"item.value\"\r\n              :value=\"item.value\">\r\n              {{ item.label }}\r\n            </a-select-option>\r\n          </a-select>\r\n        </a-form-item>\r\n        <a-form-item\r\n          label=\"用途\"\r\n          :label-col=\"{span: 6}\"\r\n          :wrapper-col=\"{span: 18}\">\r\n          <a-select\r\n            mode=\"multiple\"\r\n            placeholder=\"请选择工程用途\"\r\n            v-decorator=\"[\r\n              'purpose',\r\n              {rules: [{required: true, message: '请选择用途'}],\r\n               initialValue: project ? project.purpose : null}\r\n            ]\">\r\n            <a-select-option\r\n              v-for=\"item in purposeList\"\r\n              :key=\"item.value\"\r\n              :value=\"item.value\">\r\n              {{ item.label }}\r\n            </a-select-option>\r\n          </a-select>\r\n        </a-form-item>\r\n        <a-form-item\r\n          label=\"资金来源\"\r\n          :label-col=\"{span: 6}\"\r\n          :wrapper-col=\"{span: 18}\">\r\n          <a-select\r\n            mode=\"multiple\"\r\n            placeholder=\"请选择资金来源\"\r\n            v-decorator=\"[\r\n              'fund_sources',\r\n              {rules: [{required: true, message: '请选择资金来源'}],\r\n               initialValue: project ? project.fund_sources : null}\r\n            ]\">\r\n            <a-select-option\r\n              v-for=\"item in fundSourcesList\"\r\n              :key=\"item.value\"\r\n              :value=\"item.value\">\r\n              {{ item.label }}\r\n            </a-select-option>\r\n          </a-select>\r\n        </a-form-item>\r\n        <a-form-item\r\n          label=\"结构形式\"\r\n          :label-col=\"{span: 6}\"\r\n          :wrapper-col=\"{span: 18}\">\r\n          <a-select\r\n            mode=\"multiple\"\r\n            placeholder=\"请选择结构形式\"\r\n            v-decorator=\"[\r\n              'style',\r\n              {rules: [{required:true, message: '请选择结构形式'}],\r\n               validateTrigger: 'blur',\r\n               initialValue: project ? project.style : null}\r\n            ]\">\r\n            <a-select-option\r\n              v-for=\"item in styleList\"\r\n              :key=\"item.value\"\r\n              :value=\"item.value\">\r\n              {{ item.label }}\r\n            </a-select-option>\r\n          </a-select>\r\n        </a-form-item>\r\n        <a-form-item\r\n          label=\"建设地点\"\r\n          :label-col=\"{span: 6}\"\r\n          :wrapper-col=\"{span: 18}\">\r\n          <a-input\r\n            type=\"text\"\r\n            autocomplete=\"true\"\r\n            placeholder=\"XXX路XXX号\"\r\n            v-decorator=\"[\r\n              'place',\r\n              {rules: [\r\n                 {required: true, message: '请输入建设地点'},\r\n                 {max:64,message:'长度在64个汉字以内'}\r\n               ],\r\n               validateTrigger: 'blur',\r\n               initialValue: project ? project.place : null}\r\n            ]\">\r\n          </a-input>\r\n        </a-form-item>\r\n        <a-form-item\r\n          label=\"开工日期\"\r\n          :label-col=\"{span: 6}\"\r\n          :wrapper-col=\"{span: 18}\">\r\n          <a-date-picker\r\n            style=\"width:100%\"\r\n            v-decorator=\"[\r\n              'starting_date',\r\n              {rules: [{type: 'object', required: true, message: '请输入开工日期'}],\r\n               initialValue: project ? project.starting_date : null}\r\n            ]\"></a-date-picker>\r\n        </a-form-item>\r\n        <a-form-item\r\n          label=\"预计竣工日期\"\r\n          :label-col=\"{span: 6}\"\r\n          :wrapper-col=\"{span: 18}\">\r\n          <a-date-picker\r\n            style=\"width:100%\"\r\n            v-decorator=\"[\r\n              'finishing_date',\r\n              {rules: [{type: 'object',required: true, message: '请输入预计竣工日期'}],\r\n               initialValue: project ? project.finishing_date : null}\r\n            ]\"></a-date-picker>\r\n        </a-form-item>\r\n        <a-form-item\r\n          label=\"工程总造价\"\r\n          :label-col=\"{span: 6}\"\r\n          :wrapper-col=\"{span: 18}\">\r\n          <a-input\r\n            type=\"number\"\r\n            autocomplete=\"true\"\r\n            placeholder=\"1000\"\r\n            addonAfter=\"万元\"\r\n            v-decorator=\"['cost',{initialValue: project ? project.cost : null}]\">\r\n          </a-input>\r\n        </a-form-item>\r\n        <a-form-item\r\n          label=\"投资额\"\r\n          :label-col=\"{span: 6}\"\r\n          :wrapper-col=\"{span: 18}\">\r\n          <a-input\r\n            type=\"decimal(5,2)\"\r\n            autocomplete=\"true\"\r\n            placeholder=\"1000\"\r\n            addonAfter=\"万元\"\r\n            v-decorator=\"['investment', {initialValue: project ? project.investment : null}]\">\r\n          </a-input>\r\n        </a-form-item>\r\n        <a-form-item\r\n          label=\"建筑面积\"\r\n          :label-col=\"{span: 6}\"\r\n          :wrapper-col=\"{span: 18}\">\r\n          <a-input\r\n            type=\"number\"\r\n            autocomplete=\"true\"\r\n            placeholder=\"1000\"\r\n            addonAfter=\"平方米\"\r\n            v-decorator=\"['area',{initialValue: project ? project.area : null}]\">\r\n          </a-input>\r\n        </a-form-item>\r\n        <a-form-item\r\n          label=\"施工条件\"\r\n          :label-col=\"{span: 6}\"\r\n          :wrapper-col=\"{span: 18}\">\r\n          <a-textarea\r\n            placeholder=\"请输入施工条件（不多于2000字）\"\r\n            :rows=\"4\"\r\n            v-decorator=\"[\r\n              'condition',\r\n              {rules: [\r\n                 {max:2000, message:'长度在2000个汉字以内'}\r\n               ],\r\n               initialValue: project ? project.condition : null,\r\n               validateTrigger: 'blur'}\r\n            ]\"></a-textarea>\r\n        </a-form-item>\r\n        <a-form-item\r\n          label=\"项目简介\"\r\n          :label-col=\"{span: 6}\"\r\n          :wrapper-col=\"{span: 18}\">\r\n          <a-textarea\r\n            placeholder=\"请输入项目简介（不多于2000字）\"\r\n            :rows=\"4\"\r\n            v-decorator=\"[\r\n              'introduction',\r\n              {rules: [\r\n                 {max:2000, message:'长度在2000个汉字以内'}\r\n               ],\r\n               validateTrigger: 'blur',\r\n               initialValue: project ? project.introduction : null}\r\n            ]\"></a-textarea>\r\n        </a-form-item>\r\n        <a-form-item>\r\n          <div style=\"text-align: right\">\r\n            <a-button\r\n              :disabled=\"project === null\"\r\n              type=\"danger\"\r\n              style=\"margin-right: 20px\"\r\n              @click=\"handelDelete\">\r\n              删除\r\n            </a-button>\r\n            <a-button\r\n              :disabled=\"project === null\"\r\n              type=\"primary\"\r\n              @click=\"handleSubmit\">\r\n              更新\r\n            </a-button>\r\n          </div>\r\n        </a-form-item>\r\n      </a-form>\r\n    </a-col>\r\n  </a-card>\r\n</template>\r\n\r\n<script>\r\n  import projectApi from '../../api/project'\r\n  import detailApi from '../../api/detail'\r\n  import moment from 'moment'\r\n  import { mapGetters } from 'vuex'\r\n\r\n  export default {\r\n    name: 'DetailEdit',\r\n    data () {\r\n      return {\r\n        form: this.$form.createForm(this),\r\n        scaleList: [],\r\n        propertyList: [],\r\n        purposeList: [],\r\n        fundSourcesList: [],\r\n        styleList: [],\r\n        project: null\r\n      }\r\n    },\r\n    mounted () {\r\n      this.getProjectDetail()\r\n      projectApi.getScaleList()\r\n        .then(data => {\r\n        this.scaleList = data\r\n      })\r\n      projectApi.getPropertyList()\r\n        .then(data => {\r\n        this.propertyList = data\r\n      })\r\n      projectApi.getPurposeList()\r\n        .then(data => {\r\n        this.purposeList = data\r\n      })\r\n      projectApi.getFundSourcesList()\r\n        .then(data => {\r\n        this.fundSourcesList = data\r\n      })\r\n      projectApi.getStyleList()\r\n        .then(data => {\r\n        this.styleList = data\r\n      })\r\n    },\r\n    methods: {\r\n      ...mapGetters(['projectSelected']),\r\n      getProjectDetail () {\r\n        detailApi.getProjectDetail(this.projectSelected().id)\r\n          .then(data => {\r\n          // 处理获得的数据\r\n          data.scale = data.scale.value\r\n          data.style = data.style.map(value => {\r\n            return value.value\r\n          })\r\n          data.property = data.property.map(value => {\r\n            return value.value\r\n          })\r\n          data.purpose = data.purpose.map(value => {\r\n            return value.value\r\n          })\r\n          data.fund_sources = data.fund_sources.map(value => {\r\n            return value.value\r\n          })\r\n          data.starting_date = new moment(data.starting_date)\r\n          data.finishing_date = new moment(data.finishing_date)\r\n          this.project = data\r\n        })\r\n      },\r\n      handleSubmit (e) {\r\n        e.preventDefault()\r\n        this.form.validateFields((error, data) => {\r\n          if (!error) {\r\n            data.starting_date = data.starting_date.format('YYYY-MM-DD')\r\n            data.finishing_date = data.finishing_date.format('YYYY-MM-DD')\r\n            detailApi.updateProject(data)\r\n              .then(data => {\r\n              this.$notification.success({message: '成功', description: '修改成功', key: 'SUCCESS'})\r\n              this.$router.push({ name: 'detail' })\r\n            })\r\n          }\r\n        })\r\n      },\r\n      handelDelete () {\r\n        this.$confirm({\r\n          title: '此操作不可逆，请再次确定是否删除项目。',\r\n          okText: '删除',\r\n          okType: 'danger',\r\n          onOk () {\r\n            console.log('deleted')\r\n          }\r\n        })\r\n      },\r\n      validateID (rule, value, callback) {\r\n        projectApi.validateID(value)\r\n          .then(data => {\r\n          if (data.result === '此项目编号已被使用！') {\r\n            callback(data.result)\r\n          } else {\r\n            callback()\r\n          }\r\n        })\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped lang=\"stylus\">\r\n\r\n</style>\r\n"],"sourceRoot":"src/views/detail"}]}