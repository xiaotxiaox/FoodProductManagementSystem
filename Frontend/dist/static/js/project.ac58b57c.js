(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["project"],{"24d2":function(e,t,a){"use strict";var i=a("1c1e");t["a"]={getProjectList:function(e){return Object(i["a"])("project/","get",null,e)},createProject:function(e){return Object(i["a"])("project/","post",e)},getProject:function(e){return Object(i["a"])("project/".concat(e,"/"),"get")},updateProject:function(e){return Object(i["a"])("project/".concat(e.id,"/"),"put",e)},deleteProject:function(e){return Object(i["a"])("project/".concat(e,"/"),"delete")},getScaleList:function(){return Object(i["a"])("project/scale/","get")},getPropertyList:function(){return Object(i["a"])("project/property/","get")},getPurposeList:function(){return Object(i["a"])("project/purpose/","get")},getFundSourcesList:function(){return Object(i["a"])("project/fundSources/","get")},getStyleList:function(){return Object(i["a"])("project/style/","get")},validateID:function(e){return Object(i["a"])("project/checkID/","post",{id:e})}}},3372:function(e,t,a){"use strict";var i=a("3854"),s=a.n(i);s.a},3854:function(e,t,a){},"386a":function(e,t,a){"use strict";var i=a("4e84"),s=a.n(i);s.a},"4e84":function(e,t,a){},"956c":function(e,t,a){"use strict";var i=a("b1bc"),s=a.n(i);s.a},b1bc:function(e,t,a){},b7bc:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("page-layout",{attrs:{title:"项目列表"}},[a("a-card",{staticClass:"project"},[e.project?a("a-card",{staticClass:"card card-selected"},[a("project-card",{attrs:{project:e.project}})],1):a("a-card",{staticClass:"card card-selected",staticStyle:{"text-align":"center"}},[e._v("\n      未选择项目\n    ")]),a("a-input-group",{staticClass:"tool"},[a("a-row",{attrs:{gutter:6}},[a("a-col",{staticClass:"item",attrs:{xs:{span:12},sm:{span:8},xl:{span:4}}},[a("a-select",{staticStyle:{width:"100%"},on:{change:e.getData},model:{value:e.params.ordering,callback:function(t){e.$set(e.params,"ordering",t)},expression:"params.ordering"}},[a("a-select-option",{attrs:{value:"starting_date"}},[e._v("开工时间正排序")]),a("a-select-option",{attrs:{value:"-starting_date"}},[e._v("开工时间倒排序")]),a("a-select-option",{attrs:{value:"finishing_date"}},[e._v("竣工时间正排序")]),a("a-select-option",{attrs:{value:"-finishing_date"}},[e._v("竣工时间倒排序")]),a("a-select-option",{attrs:{value:"investment"}},[e._v("项目投资正排序")]),a("a-select-option",{attrs:{value:"-investment"}},[e._v("项目投资倒排序")])],1)],1),a("a-col",{staticClass:"item",attrs:{xs:{span:12},sm:{span:8},xl:{span:4}}},[a("a-select",{staticStyle:{width:"100%"},on:{change:e.handleFilterByInvestment},model:{value:e.filter.investment,callback:function(t){e.$set(e.filter,"investment",t)},expression:"filter.investment"}},[a("a-select-option",{attrs:{value:""}},[e._v("投资额筛选")]),a("a-select-option",{attrs:{value:1}},[e._v("500万以下")]),a("a-select-option",{attrs:{value:2}},[e._v("500万~1000万")]),a("a-select-option",{attrs:{value:3}},[e._v("1000万~2000万")]),a("a-select-option",{attrs:{value:4}},[e._v("2000万以上")])],1)],1),a("a-col",{staticClass:"item",attrs:{xs:{span:12},sm:{span:8},xl:{span:4}}},[a("a-select",{staticStyle:{width:"100%"},on:{change:e.handleFilterByYear},model:{value:e.filter.year,callback:function(t){e.$set(e.filter,"year",t)},expression:"filter.year"}},[a("a-select-option",{attrs:{value:""}},[e._v("开工年份筛选")]),e._l(e.yearList,function(t,i){return a("a-select-option",{key:i,attrs:{value:i}},[e._v(e._s(t)+"年\n            ")])}),a("a-select-option",{attrs:{value:4}},[e._v(e._s(e.yearList[e.yearList.length-1])+"年之前")])],2)],1),a("a-col",{staticClass:"item",attrs:{xs:{span:24},sm:{span:8},xl:{span:4}}},[a("a-input",{staticStyle:{width:"100%"},attrs:{placeholder:"项目名称，建设地点"},model:{value:e.params.search,callback:function(t){e.$set(e.params,"search",t)},expression:"params.search"}})],1),a("a-col",{staticClass:"item",attrs:{xs:{span:12},sm:{span:8},xl:{span:4}}},[a("a-button",{staticStyle:{width:"100%"},attrs:{icon:"search"},on:{click:e.handleSearch}},[e._v("\n            搜索\n          ")])],1),a("a-col",{staticClass:"item",attrs:{xs:{span:12},sm:{span:8},xl:{span:4}}},[a("a-button",{staticStyle:{width:"100%"},attrs:{icon:"delete"},on:{click:e.handleClearParams}},[e._v("\n            重置\n          ")])],1)],1),a("a-row",{attrs:{gutter:6}},[a("a-col",{directives:[{name:"action",rawName:"v-action:add",arg:"add"}],staticClass:"item",attrs:{xs:{span:24},sm:{span:8,offset:16},xl:{span:4,offset:20}}},[a("a-button",{staticStyle:{width:"100%"},attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.$router.push({name:"projectCreate"})}}},[e._v("\n            新建项目\n          ")])],1)],1)],1),a("a-spin",{attrs:{spinning:e.status.loading}},[e.projectCount?e._e():a("a-card",{staticClass:"card",staticStyle:{"text-align":"center"}},[e._v("\n        暂无数据\n      ")]),e._l(e.projectList,function(t){return a("a-card",{key:t.id,staticClass:"card card-hover",on:{click:function(a){return e.handleProjectSelect(t)}}},[a("project-card",{attrs:{project:t}})],1)})],2),a("a-pagination",{staticStyle:{float:"right"},attrs:{defaultPageSize:10,total:e.projectCount},on:{change:e.handelePage},model:{value:e.params.page,callback:function(t){e.$set(e.params,"page",t)},expression:"params.page"}}),a("div",{staticStyle:{margin:"0 20px 10px 0"}},[e._v("共 "+e._s(this.projectCount)+" 个")])],1)],1)},s=[],r=(a("386d"),a("cebc")),n=a("2f62"),o=a("a18c"),l=a("b445"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-row",[a("a-col",{staticStyle:{"text-align":"center"},attrs:{xs:{span:0},sm:{span:2},xl:{span:2}}},[a("br"),a("a-icon",{staticStyle:{"font-size":"40px"},attrs:{type:"bank",theme:"filled"}})],1),a("a-col",{attrs:{xs:{span:20},sm:{span:18},xl:{span:18}}},[a("div",[e._v("名称："+e._s(e.project.name))]),a("div",[e._v("编号："+e._s(e.project.id))]),a("div",[e._v("开工日期："+e._s(e.project.starting_date))]),a("div",[e._v("预计竣工日期："+e._s(e.project.finishing_date))]),a("div",[e._v("建设地点："+e._s(e.project.place))])]),a("a-col",{staticStyle:{"text-align":"center"},attrs:{xs:{span:4},sm:{span:4},xl:{span:4}}},[a("br"),a("div",[e._v("已经安全生产了")]),a("div",{class:[{expire:e.isExpire}]},[a("span",{staticStyle:{"font-size":"26px"}},[e._v(e._s(e.safeDay))]),e._v("  "),a("span",[e._v("天")])])])],1)},u=[],d=a("c1df"),p=a.n(d),m={name:"ProjectCard",props:{project:Object},computed:{safeDay:function(){var e=new p.a,t=new p.a(this.project.starting_date),a=new p.a(this.project.finishing_date);return"".concat(e.diff(t,"days")+1," / ").concat(a.diff(t,"days")+1)},isExpire:function(){var e=new p.a,t=new p.a(this.project.finishing_date);return e.diff(t,"days")>0}}},v=m,f=(a("956c"),a("2877")),h=Object(f["a"])(v,c,u,!1,null,"7b2236e2",null),g=h.exports,_=a("24d2"),b=a("290c"),y={name:"Project",components:{ARow:b["a"],PageLayout:l["a"],ProjectCard:g},data:function(){return{params:{min_investment:"",max_investment:"",min_date:"",max_date:"",search:"",page:1,ordering:"-starting_date"},filter:{investment:"",year:""},status:{loading:!0},projectCount:0,projectList:[]}},mounted:function(){this.getData()},methods:Object(r["a"])({},Object(n["d"])(["SET_PROJECT"]),{getData:function(){var e=this;this.status.loading=!0,_["a"].getProjectList(this.params).then(function(t){e.projectList=t.results,e.projectCount=t.count,e.status.loading=!1})},handelePage:function(e){this.params.page=e,this.getData()},handleFilterByInvestment:function(e){switch(e){case 1:this.params.min_investment="",this.params.max_investment="500";break;case 2:this.params.min_investment="500",this.params.max_investment="1000";break;case 3:this.params.min_investment="1000",this.params.max_investment="2000";break;case 4:this.params.min_investment="2000",this.params.max_investment="";break;default:this.params.min_investment="",this.params.max_investment="",this.filter.investment="";break}this.getData()},handleFilterByYear:function(e){switch(e){case 0:this.params.min_date=this.yearList[0]+"-01-01",this.params.max_date=this.yearList[0]+"-12-31";break;case 1:this.params.min_date=this.yearList[1]+"-01-01",this.params.max_date=this.yearList[1]+"-12-31";break;case 2:this.params.min_date=this.yearList[2]+"-01-01",this.params.max_date=this.yearList[2]+"-12-31";break;case 3:this.params.min_date=this.yearList[3]+"-01-01",this.params.max_date=this.yearList[3]+"-12-31";break;case 4:this.params.max_date=this.yearList[3]+"-12-31";break;default:this.params.min_date="",this.params.max_date="",this.filter.year="";break}this.getData()},handleSearch:function(){this.getData()},handleClearParams:function(){this.filter.investment="",this.filter.year="",this.params.ordering="starting_date",this.params.min_investment="",this.params.max_investment="",this.params.min_date="",this.params.max_date="",this.params.search="",this.params.page=1,this.getData()},handleProjectSelect:function(e){this.SET_PROJECT(e);var t=this.$store.getters.role;-1===t.permissionList.indexOf("project_selected")&&t.permissionList.push("project_selected"),this.$store.commit("SET_ROLE",t),this.$store.dispatch("GenerateRoutes",{roles:t}),o["a"].addRoutes(this.$store.getters.addRouters),o["a"].push({name:"detail"})}}),computed:{project:function(){return this.$store.getters.projectSelected},yearList:function(){for(var e=[],t=(new Date).getFullYear(),a=0;a<4;a++)e.push(t-a);return e}}},j=y,x=(a("3372"),Object(f["a"])(j,i,s,!1,null,"8d48a7ec",null));t["default"]=x.exports},f6d1:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("page-layout",{attrs:{title:e.isEdit?"项目编辑":"项目新建"}},[a("a-card",[a("a-col",{staticClass:"item",attrs:{xs:{span:24},sm:{span:20},xl:{span:16}}},[a("a-form",{attrs:{form:e.form},on:{submit:e.handleSubmit}},[a("a-form-item",e._b({attrs:{label:"项目图片"}},"a-form-item",e.layout,!1),[a("a-upload",{attrs:{name:"image",action:"/api/file/",withCredentials:!0,headers:e.headers,accept:"image/*",listType:"picture-card",showUploadList:!1,beforeUpload:e.beforeUpload},on:{change:e.handleImageChange}},[e.image.url?a("img",{attrs:{src:e.image.url,alt:"项目图片",width:"200px"}}):a("div",{staticStyle:{width:"100px"}},[a("a-icon",{attrs:{type:e.status.img.loading?"loading":"plus"}}),a("div",{staticClass:"text"},[e._v("选择图片")])],1)]),a("span",[e._v("支持图片文件，不大于2MB")])],1),a("a-form-item",e._b({attrs:{label:"项目编号"}},"a-form-item",e.layout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id",{rules:[{required:!0,message:"请输入项目编号"},{max:11,message:"长度在11个字符以内"},{validator:e.validateChinese,message:"不能含有中文字符"},{validator:e.validateIDRepeat,message:"项目编号重复"}],validateTrigger:"blur",initialValue:e.isEdit?e.project.id:null}],expression:"[\n              'id',\n              {rules:[\n                {required: true, message: '请输入项目编号'},\n                {max:11, message:'长度在11个字符以内'},\n                {validator: validateChinese, message: '不能含有中文字符'},\n                {validator: validateIDRepeat, message: '项目编号重复'}\n               ],\n               validateTrigger: 'blur',\n               initialValue: isEdit ? project.id : null}\n            ]"}],attrs:{type:"text",autocomplete:"true",placeholder:"1234567890"}})],1),a("a-form-item",e._b({attrs:{label:"项目名称"}},"a-form-item",e.layout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入项目名称"},{max:256,message:"长度在256个汉字以内"}],validateTrigger:"blur",initialValue:e.isEdit?e.project.name:null}],expression:"[\n              'name',\n              {rules:[\n                {required: true, message: '请输入项目名称'},\n                {max:256, message:'长度在256个汉字以内'}\n              ], validateTrigger: 'blur',\n               initialValue: isEdit ? project.name : null}\n            ]"}],attrs:{type:"text",autocomplete:"true",placeholder:"XXX项目"}})],1),a("a-form-item",e._b({attrs:{label:"工程概况规模"}},"a-form-item",e.layout,!1),[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["scale",{rules:[{required:!0,message:"请选择工程规模"}],initialValue:e.isEdit?e.project.scale:null}],expression:"[\n              'scale',\n              {rules: [{required: true, message: '请选择工程规模'}],\n               initialValue: isEdit ? project.scale : null}\n            ]"}],attrs:{placeholder:"请选择工程概况规模"}},e._l(e.scaleList,function(t){return a("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v("\n              "+e._s(t.label)+"\n            ")])}),1)],1),a("a-form-item",e._b({attrs:{label:"性质"}},"a-form-item",e.layout,!1),[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["property",{rules:[{required:!0,message:"请选择性质"}],initialValue:e.isEdit?e.project.property:[]}],expression:"[\n              'property',\n              {rules: [{required: true, message: '请选择性质'}],\n               initialValue: isEdit ? project.property : []}\n            ]"}],attrs:{mode:"multiple",placeholder:"请选择工程性质"}},e._l(e.propertyList,function(t){return a("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v("\n              "+e._s(t.label)+"\n            ")])}),1)],1),a("a-form-item",e._b({attrs:{label:"用途"}},"a-form-item",e.layout,!1),[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["purpose",{rules:[{required:!0,message:"请选择用途"}],initialValue:e.isEdit?e.project.purpose:[]}],expression:"[\n              'purpose',\n              {rules: [{required: true, message: '请选择用途'}],\n               initialValue: isEdit ? project.purpose : []}\n            ]"}],attrs:{mode:"multiple",placeholder:"请选择工程用途"}},e._l(e.purposeList,function(t){return a("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v("\n              "+e._s(t.label)+"\n            ")])}),1)],1),a("a-form-item",e._b({attrs:{label:"资金来源"}},"a-form-item",e.layout,!1),[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["fund_sources",{rules:[{required:!0,message:"请选择资金来源"}],initialValue:e.isEdit?e.project.fund_sources:[]}],expression:"[\n              'fund_sources',\n              {rules: [{required: true, message: '请选择资金来源'}],\n               initialValue: isEdit ? project.fund_sources : []}\n            ]"}],attrs:{mode:"multiple",placeholder:"请选择资金来源"}},e._l(e.fundSourcesList,function(t){return a("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v("\n              "+e._s(t.label)+"\n            ")])}),1)],1),a("a-form-item",e._b({attrs:{label:"结构形式"}},"a-form-item",e.layout,!1),[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["style",{rules:[{required:!0,message:"请选择结构形式"}],validateTrigger:"blur",initialValue:e.isEdit?e.project.style:[]}],expression:"[\n              'style',\n              {rules: [{required:true, message: '请选择结构形式'}],validateTrigger: 'blur',\n               initialValue: isEdit ? project.style : []}\n            ]"}],attrs:{mode:"multiple",placeholder:"请选择结构形式"}},e._l(e.styleList,function(t){return a("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v("\n              "+e._s(t.label)+"\n            ")])}),1)],1),a("a-form-item",e._b({attrs:{label:"建设地点"}},"a-form-item",e.layout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["place",{rules:[{required:!0,message:"请输入建设地点"},{max:64,message:"长度在64个汉字以内"}],validateTrigger:"blur",initialValue:e.isEdit?e.project.place:null}],expression:"[\n              'place',\n              {rules: [\n                 {required: true, message: '请输入建设地点'},\n                 {max:64,message:'长度在64个汉字以内'}\n               ],\n               validateTrigger: 'blur',\n               initialValue: isEdit ? project.place : null}\n            ]"}],attrs:{type:"text",autocomplete:"true",placeholder:"XXX路XXX号"}})],1),a("a-form-item",e._b({attrs:{label:"开工日期"}},"a-form-item",e.layout,!1),[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["starting_date",{rules:[{type:"object",required:!0,message:"请输入开工日期"}],initialValue:e.isEdit?e.project.starting_date:null}],expression:"[\n              'starting_date',\n              {rules: [{ type: 'object', required: true, message: '请输入开工日期' }],\n               initialValue: isEdit ? project.starting_date : null}\n            ]"}],staticStyle:{width:"100%"}})],1),a("a-form-item",e._b({attrs:{label:"预计竣工日期"}},"a-form-item",e.layout,!1),[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["finishing_date",{rules:[{type:"object",required:!0,message:"请输入建设地点"}],initialValue:e.isEdit?e.project.finishing_date:null}],expression:"[\n              'finishing_date',\n              {rules: [{ type: 'object',required: true, message: '请输入建设地点' }],\n               initialValue: isEdit ? project.finishing_date : null}\n            ]"}],staticStyle:{width:"100%"}})],1),a("a-form-item",e._b({attrs:{label:"工程总造价"}},"a-form-item",e.layout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["cost",{initialValue:e.isEdit?e.project.cost:null}],expression:"[\n              'cost',\n              {\n                initialValue: isEdit ? project.cost : null\n              }\n            ]"}],attrs:{type:"number",autocomplete:"true",placeholder:"1000",addonAfter:"万元"}})],1),a("a-form-item",e._b({attrs:{label:"投资额"}},"a-form-item",e.layout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["investment",{initialValue:e.isEdit?e.project.investment:null}],expression:"[\n            'investment',\n              {\n                initialValue: isEdit ? project.investment : null\n              }\n            ]"}],attrs:{type:"decimal(5,2)",autocomplete:"true",placeholder:"1000",addonAfter:"万元"}})],1),a("a-form-item",e._b({attrs:{label:"建筑面积"}},"a-form-item",e.layout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["area",{initialValue:e.isEdit?e.project.area:null}],expression:"[\n            'area',\n              {\n                initialValue: isEdit ? project.area : null\n              }\n            ]"}],attrs:{type:"number",autocomplete:"true",placeholder:"1000",addonAfter:"平方米"}})],1),a("a-form-item",e._b({attrs:{label:"施工条件"}},"a-form-item",e.layout,!1),[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["condition",{rules:[{max:2e3,message:"长度在2000个汉字以内"}],validateTrigger:"blur",initialValue:e.isEdit?e.project.condition:null}],expression:"[\n              'condition',\n              {\n                rules: [\n                 { max:2000, message:'长度在2000个汉字以内' }\n                ],\n                validateTrigger: 'blur',\n                initialValue: isEdit ? project.condition : null\n              }\n            ]"}],attrs:{placeholder:"请输入施工条件（不多于2000字）",rows:4}})],1),a("a-form-item",e._b({attrs:{label:"项目简介"}},"a-form-item",e.layout,!1),[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["introduction",{rules:[{max:2e3,message:"长度在2000个汉字以内"}],validateTrigger:"blur",initialValue:e.isEdit?e.project.introduction:null}],expression:"[\n              'introduction',\n              {\n                rules: [\n                  { max:2000, message:'长度在2000个汉字以内' }\n                ],\n                validateTrigger: 'blur',\n                initialValue: isEdit ? project.introduction : null\n              }\n            ]"}],attrs:{placeholder:"请输入项目简介（不多于2000字）",rows:4}})],1),a("a-form-item",[e.isEdit?e._e():a("a-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("\n            提交\n          ")]),e.isEdit?e._e():a("a-button",{staticClass:"btn",on:{click:e.handelClearForm}},[e._v("\n            重置\n          ")]),e.isEdit?a("a-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("\n            更新\n          ")]):e._e(),a("a-popconfirm",{attrs:{title:"是否确定删除？"},on:{confirm:e.handelDelete}},[e.isEdit?a("a-button",{staticClass:"btn",attrs:{type:"danger"}},[e._v("\n              删除\n            ")]):e._e()],1),a("a-button",{staticClass:"btn",on:{click:function(t){return e.$router.go(-1)}}},[e._v("\n            返回\n          ")])],1)],1)],1)],1)],1)},s=[],r=(a("28a5"),a("7f7f"),a("6b54"),a("06db"),a("cebc")),n=a("b445"),o=a("24d2"),l=a("c1df"),c=a.n(l),u=a("ca00"),d=a("2f62"),p={name:"ProjectDetail",components:{PageLayout:n["a"]},data:function(){return{layout:{"label-col":{span:6},"wrapper-col":{span:18}},status:{img:{loading:!1}},form:this.$form.createForm(this),scaleList:[],propertyList:[],purposeList:[],fundSourcesList:[],styleList:[],project:{},image:{url:"",uuid:""},headers:{"X-CSRFToken":Object(u["a"])("csrftoken")}}},mounted:function(){this.getData()},methods:Object(r["a"])({},Object(d["c"])(["projectSelected"]),{getData:function(){var e=this;o["a"].getScaleList().then(function(t){e.scaleList=t}),o["a"].getPropertyList().then(function(t){e.propertyList=t}),o["a"].getPurposeList().then(function(t){e.purposeList=t}),o["a"].getFundSourcesList().then(function(t){e.fundSourcesList=t}),o["a"].getStyleList().then(function(t){e.styleList=t}),this.isEdit&&o["a"].getProject(this.projectSelected().id).then(function(t){t.scale=t.scale.value,t.style=t.style.map(function(e){return e.value}),t.property=t.property.map(function(e){return e.value}),t.purpose=t.purpose.map(function(e){return e.value}),t.fund_sources=t.fund_sources.map(function(e){return e.value}),t.starting_date=new c.a(t.starting_date),t.finishing_date=new c.a(t.finishing_date),t.images&&(e.image=t.images),e.project=t})},handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields(function(e,a){e||(a.starting_date=a.starting_date.format("YYYY-MM-DD"),a.finishing_date=a.finishing_date.format("YYYY-MM-DD"),a.uuid=t.image.uuid,t.isEdit?o["a"].updateProject(a).then(function(e){t.$notification.success({message:"成功",description:"修改项目成功",key:"SUCCESS"}),t.$router.push({name:"detail"})}):o["a"].createProject(a).then(function(e){t.$notification.success({message:"成功",description:"新建项目成功",key:"SUCCESS"}),t.$router.push({name:"project"})}))})},handelDelete:function(){var e=this;o["a"].deleteProject(this.project.id).then(function(t){e.$notification.success({message:"成功",description:"删除成功",key:"SUCCESS"}),e.$router.push({name:"project"}),window.history.go(0)})},handelClearForm:function(){this.form.resetFields()},handleImageChange:function(e){"uploading"===e.file.status?this.loading=!0:"done"===e.file.status?(this.image.uuid=e.file.response.uuid,this.image.url=e.file.response.url.toString(),this.loading=!1):"error"===e.file.status&&(this.$message.error("".concat(e.file.name," 上传失败.")),this.loading=!1)},beforeUpload:function(e){var t=/image\/*/.test(e.type);t||this.$message.error("图片格式不正确");var a=e.size/1024/1024<=2;return a||this.$message.error("图片大小请小于2MB"),t&&a},validateIDRepeat:function(e,t,a){this.isEdit?a():o["a"].validateID(t).then(function(e){"true"===e?a("项目编号重复"):a()})},validateChinese:function(e,t,a){/[\u4e00-\u9fa5]/.test(t)?a("id can not contain chinese"):a()}}),computed:{isEdit:function(){return"edit"===this.$route.path.split("/").pop()}}},m=p,v=(a("386a"),a("2877")),f=Object(v["a"])(m,i,s,!1,null,"31592ef2",null);t["default"]=f.exports}}]);
//# sourceMappingURL=project.ac58b57c.js.map