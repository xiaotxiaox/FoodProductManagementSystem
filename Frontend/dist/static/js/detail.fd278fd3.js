(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["detail"],{1075:function(e,t,a){"use strict";var r=a("5af0"),n=a.n(r);n.a},"21b6":function(e,t,a){"use strict";var r=a("b63a"),n=a.n(r);n.a},"24d2":function(e,t,a){"use strict";var r=a("1c1e");t["a"]={getProjectList:function(e){return Object(r["a"])("project/","get",null,e)},createProject:function(e){return Object(r["a"])("project/","post",e)},getProject:function(e){return Object(r["a"])("project/".concat(e,"/"),"get")},updateProject:function(e){return Object(r["a"])("project/".concat(e.id,"/"),"put",e)},deleteProject:function(e){return Object(r["a"])("project/".concat(e,"/"),"delete")},getScaleList:function(){return Object(r["a"])("project/scale/","get")},getPropertyList:function(){return Object(r["a"])("project/property/","get")},getPurposeList:function(){return Object(r["a"])("project/purpose/","get")},getFundSourcesList:function(){return Object(r["a"])("project/fundSources/","get")},getStyleList:function(){return Object(r["a"])("project/style/","get")},validateID:function(e){return Object(r["a"])("project/checkID/","post",{id:e})}}},"5af0":function(e,t,a){},"6ab7":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.project?a("a-card",{staticClass:"detail"},[a("a-row",[a("a-col",{attrs:{xs:{span:20,offset:2},sm:{span:16,offset:4},xl:{span:12,offset:6}}},[e.project.images?a("img",{staticClass:"img",attrs:{src:e.project.images.url,alt:"项目图片"}}):e._e()])],1),a("a-card",[a("template",{slot:"title"},[a("span",{staticStyle:{"font-size":"18px"}},[e._v("项目信息")])]),a("a-row",[a("a-col",e._b({staticClass:"item"},"a-col",e.layout,!1),[a("span",{staticClass:"label"},[e._v("项目名称:")]),e._v(e._s(e.project.name)+"\n      ")]),a("a-col",e._b({staticClass:"item"},"a-col",e.layout,!1),[a("span",{staticClass:"label"},[e._v("项目编号:")]),e._v(e._s(e.project.id)+"\n      ")]),a("a-col",e._b({staticClass:"item"},"a-col",e.layout,!1),[a("span",{staticClass:"label"},[e._v("建设地点:")]),e._v(e._s(e.project.place)+"\n      ")]),a("a-col",e._b({staticClass:"item"},"a-col",e.layout,!1),[a("span",{staticClass:"label"},[e._v("工程概况规模:")]),e._v(e._s(e.project.scale.label)+"\n      ")]),a("a-col",e._b({staticClass:"item"},"a-col",e.layout,!1),[a("span",{staticClass:"label"},[e._v("性质:")]),e._l(e.project.property,function(t){return a("span",[e._v(e._s(t.label)+" ")])})],2),a("a-col",e._b({staticClass:"item"},"a-col",e.layout,!1),[a("span",{staticClass:"label"},[e._v("用途:")]),e._l(e.project.purpose,function(t){return a("span",[e._v(e._s(t.label)+" ")])})],2),a("a-col",e._b({staticClass:"item"},"a-col",e.layout,!1),[a("span",{staticClass:"label"},[e._v("资金来源:")]),e._l(e.project.fund_sources,function(t){return a("span",[e._v(e._s(t.label)+" ")])})],2),a("a-col",e._b({staticClass:"item"},"a-col",e.layout,!1),[a("span",{staticClass:"label"},[e._v("结构形式:")]),e._l(e.project.style,function(t){return a("span",[e._v(e._s(t.label)+" ")])})],2),a("a-col",e._b({staticClass:"item"},"a-col",e.layout,!1),[a("span",{staticClass:"label"},[e._v("总建筑面积:")]),e._v(e._s(e.project.area)+"平方米\n      ")]),a("a-col",e._b({staticClass:"item"},"a-col",e.layout,!1),[a("span",{staticClass:"label"},[e._v("开工日期:")]),e._v(e._s(e.project.starting_date)+"\n      ")]),a("a-col",e._b({staticClass:"item"},"a-col",e.layout,!1),[a("span",{staticClass:"label"},[e._v("预计竣工日期:")]),e._v(e._s(e.project.finishing_date)+"\n      ")]),a("a-col",e._b({staticClass:"item"},"a-col",e.layout,!1),[a("span",{staticClass:"label"},[e._v("工程总造价:")]),e._v(e._s(e.project.cost)+"\n      ")]),a("a-col",e._b({staticClass:"item"},"a-col",e.layout,!1),[a("span",{staticClass:"label"},[e._v("投资额:")]),e._v(e._s(e.project.investment)+"\n      ")]),a("a-col",e._b({staticClass:"item"},"a-col",e.layout,!1),[a("span",{staticClass:"label"},[e._v("施工条件:")]),e._v(e._s(e.project.condition)+"\n      ")]),a("a-col",e._b({staticClass:"item"},"a-col",e.layout,!1),[a("span",{staticClass:"label"},[e._v("项目简介:")]),e._v(e._s(e.project.introduction)+"\n      ")])],1)],2),a("a-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:function(t){return e.$router.push({name:"projectEdit"})}}},[e._v("\n    编辑\n  ")]),a("a-popconfirm",{attrs:{title:"是否完成了工程?",okText:"确定",cancelText:"取消"},on:{confirm:e.handleFinish}},[a("a-button",{staticClass:"btn",attrs:{type:"danger"}},[e._v("\n      竣工\n    ")])],1)],1):a("a-card",[a("a-skeleton",{attrs:{active:""}})],1)},n=[],s=a("cebc"),l=a("24d2"),o=a("2f62"),i={name:"Detail",data:function(){return{layout:{xs:{span:24},sm:{span:12},xl:{span:8}},project:null}},mounted:function(){this.getData()},methods:Object(s["a"])({},Object(o["c"])(["projectSelected"]),{getData:function(){var e=this;l["a"].getProject(this.projectSelected().id).then(function(t){t.cost&&(t.cost+="万元"),t.investment&&(t.investment+="万元"),e.project=t})},handleFinish:function(){alert("竣工")}})},c=i,u=(a("1075"),a("2877")),m=Object(u["a"])(c,r,n,!1,null,"5113ecd1",null);t["default"]=m.exports},7644:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.modal.visible?a("contact-modal",{attrs:{record:e.modal.record,visible:e.modal.visible,type:e.modal.type},on:{close:function(t){return e.handleClose()}}}):e._e(),a("a-card",[a("a-row",{attrs:{gutter:6}},[a("a-col",e._b({staticClass:"item"},"a-col",e.layout,!1),[a("a-select",{staticStyle:{width:"100%"},on:{change:function(t){return e.getData()}},model:{value:e.params.ordering,callback:function(t){e.$set(e.params,"ordering",t)},expression:"params.ordering"}},[a("a-select-option",{attrs:{value:""}},[e._v("排序")]),a("a-select-option",{attrs:{value:"company"}},[e._v("单位正排序")]),a("a-select-option",{attrs:{value:"-company"}},[e._v("单位倒排序")]),a("a-select-option",{attrs:{value:"name"}},[e._v("姓名正排序")]),a("a-select-option",{attrs:{value:"-name"}},[e._v("姓名倒排序")])],1)],1),a("a-col",e._b({staticClass:"item"},"a-col",e.layout,!1),[a("a-select",{staticStyle:{width:"100%"},on:{change:function(t){return e.getData()}},model:{value:e.params.company_type,callback:function(t){e.$set(e.params,"company_type",t)},expression:"params.company_type"}},[a("a-select-option",{attrs:{value:""}},[e._v("类型筛选")]),e._l(e.typeList,function(t){return a("a-select-option",{attrs:{value:t.value}},[e._v(e._s(t.label))])})],2)],1),a("a-col",e._b({staticClass:"item"},"a-col",e.layout,!1),[a("a-input",{staticStyle:{width:"100%"},attrs:{placeholder:"单位，姓名，岗位"},model:{value:e.params.search,callback:function(t){e.$set(e.params,"search",t)},expression:"params.search"}})],1),a("a-col",e._b({staticClass:"item"},"a-col",e.layout,!1),[a("a-button",{staticStyle:{width:"100%"},attrs:{icon:"search"},on:{click:function(t){return e.getData()}}},[e._v("\n          搜索\n        ")])],1),a("a-col",e._b({staticClass:"item"},"a-col",e.layout,!1),[a("a-button",{staticStyle:{width:"100%"},attrs:{icon:"delete"},on:{click:function(t){return e.handleClearParams()}}},[e._v("\n          重置\n        ")])],1),a("a-col",e._b({staticClass:"item"},"a-col",e.layout,!1),[a("a-button",{staticStyle:{width:"100%"},attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.handleCreate()}}},[e._v("\n          新建\n        ")])],1)],1),a("a-table",{staticClass:"item",attrs:{bordered:"",columns:e.columns,dataSource:e.data,rowKey:"id",pagination:!1,loading:e.status.loading},scopedSlots:e._u([{key:"operation",fn:function(t,r,n){return[a("a-button",{staticClass:"button",on:{click:function(t){return e.handleEdit(r)}}},[e._v("编辑")]),a("a-popconfirm",{attrs:{title:"确认删除吗?"},on:{confirm:function(t){return e.handleDelete(r)}}},[a("a-button",{staticClass:"button",attrs:{type:"danger"}},[e._v("删除")])],1)]}}])}),a("a-pagination",{staticClass:"item",staticStyle:{float:"right"},attrs:{total:e.count},on:{change:e.handelePage},model:{value:e.params.page,callback:function(t){e.$set(e.params,"page",t)},expression:"params.page"}})],1)],1)},n=[],s=(a("386d"),a("cebc")),l=a("1c1e"),o={getAddressList:function(e){return Object(l["a"])("project/addressList/","get",null,e)},createAddressList:function(e,t){return Object(l["a"])("project/addressList/","post",e,t)},updateAddressList:function(e){return Object(l["a"])("project/addressList/".concat(e.id,"/"),"put",e)},deleteAddressListDetail:function(e){return Object(l["a"])("project/addressList/".concat(e),"delete")},getTypeList:function(){return Object(l["a"])("project/companyType/","get")}},i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,visible:e.visible,keyboard:!1,maskClosable:!1,okText:"保存",okType:"primary"},on:{ok:function(t){return e.handleOk()},cancel:function(t){return e.handleCancel()}}},[e.isEdit?a("a-form",{attrs:{form:e.form}},[a("a-form-item",e._b({attrs:{label:"单位"}},"a-form-item",e.layout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["company",{rules:[{required:!0,message:"请输入单位名称"},{max:32,message:"长度在32个汉字以内"}],validateTrigger:"blur",initialValue:e.record?e.record.company:null}],expression:"[\n          'company',\n              {rules:[\n                {required: true, message: '请输入单位名称'},\n                {max:32, message:'长度在32个汉字以内'}\n              ],\n              validateTrigger: 'blur',\n              initialValue: record ? record.company : null}\n            ]"}],attrs:{type:"text",autocomplete:"true"}})],1),a("a-form-item",e._b({attrs:{label:"单位类型"}},"a-form-item",e.layout,!1),[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["company_type",{rules:[{required:!0,message:"请选择单位类型"}],initialValue:e.record?e.record.company_type.value:null}],expression:"[\n         'company_type',\n         {\n           rules: [\n            {required: true, message: '请选择单位类型'}\n           ],\n           initialValue: record ? record.company_type.value : null\n         }\n       ]"}],attrs:{placeholder:"请选择单位类型"}},e._l(e.typeList,function(t){return a("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v("\n          "+e._s(t.label)+"\n        ")])}),1)],1),a("a-form-item",e._b({attrs:{label:"姓名"}},"a-form-item",e.layout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入负责人姓名"},{max:8,message:"长度在8个汉字以内"}],validateTrigger:"blur",initialValue:e.record?e.record.name:null}],expression:"[\n              'name',\n              {rules: [\n                 {required: true, message: '请输入负责人姓名'},\n                 {max:8,message:'长度在8个汉字以内'}\n               ],\n               validateTrigger: 'blur',\n               initialValue: record ? record.name : null}\n            ]"}],attrs:{type:"text",autocomplete:"true",placeholder:"请输入负责人姓名"}})],1),a("a-form-item",e._b({attrs:{label:"岗位"}},"a-form-item",e.layout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["job",{rules:[{max:8,message:"长度在8个汉字以内"}],validateTrigger:"blur",initialValue:e.record?e.record.job:null}],expression:"[\n              'job',\n              {rules: [\n                 {max:8,message:'长度在8个汉字以内'}\n               ],\n               validateTrigger: 'blur',\n               initialValue: record ? record.job : null}\n            ]"}],attrs:{type:"text",autocomplete:"true"}})],1),a("a-form-item",e._b({attrs:{label:"邮箱"}},"a-form-item",e.layout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email",{rules:[{type:"email",message:"请输入正确邮箱地址"}],validateTrigger:"blur",initialValue:e.record?e.record.email:null}],expression:"[\n              'email',\n              {rules: [\n              {\n            type: 'email', message: '请输入正确邮箱地址',\n          }\n               ],\n               validateTrigger: 'blur',\n               initialValue: record ? record.email : null}\n            ]"}],attrs:{type:"email",autocomplete:"true",placeholder:"123456@163.com"}})],1),a("a-form-item",e._b({attrs:{label:"联系电话"}},"a-form-item",e.layout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["telephone",{rules:[{required:!0,message:"请输入联系电话"},{pattern:/^[1][3,4,5,7,8][0-9]{9}$/,message:"联系电话格式错误"}],validateTrigger:"blur",initialValue:e.record?e.record.telephone:null}],expression:"[\n                          'telephone',\n                          {rules: [\n                                  {required: true, message: '请输入联系电话'},\n                                  {pattern:/^[1][3,4,5,7,8][0-9]{9}$/, message: '联系电话格式错误'}\n                                  ],\n                          validateTrigger: 'blur',\n                          initialValue: record ? record.telephone : null}\n                          ]"}],attrs:{type:"phone",autocomplete:"true",placeholder:"13812341234"}})],1),a("a-form-item",e._b({attrs:{label:"备注"}},"a-form-item",e.layout,!1),[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["note",{rules:[{max:120,message:"长度在120个汉字以内"}],validateTrigger:"blur",initialValue:e.record?e.record.note:null}],expression:"[\n              'note',\n              {rules: [\n                 {max:120, message:'长度在120个汉字以内'}\n               ],\n               validateTrigger: 'blur',\n               initialValue: record ? record.note : null}\n            ]"}],attrs:{placeholder:"请输入备注（不多于120字）",rows:4}})],1)],1):a("a-form",{attrs:{form:e.form}},[a("a-form-item",e._b({attrs:{prop:"company",label:"单位"}},"a-form-item",e.layout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["company",{rules:[{required:!0,message:"请输入单位名称"},{max:32,message:"长度在32个汉字以内"}],validateTrigger:"blur"}],expression:"[\n              'company',\n              {rules:[\n                {required: true, message: '请输入单位名称'},\n                {max:32, message:'长度在32个汉字以内'}\n              ], validateTrigger: 'blur'}\n            ]"}],attrs:{type:"text",autocomplete:"true"}})],1),a("a-form-item",e._b({attrs:{label:"单位类型"}},"a-form-item",e.layout,!1),[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["company_type",{rules:[{required:!0,message:"请选择单位类型"}]}],expression:"[\n              'company_type',\n              {rules: [{required: true, message: '请选择单位类型'}]}\n            ]"}],attrs:{placeholder:"请选择单位类型"}},e._l(e.typeList,function(t){return a("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v("\n          "+e._s(t.label)+"\n        ")])}),1)],1),a("a-form-item",e._b({attrs:{label:"姓名"}},"a-form-item",e.layout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入负责人姓名"},{max:8,message:"长度在8个汉字以内"}],validateTrigger:"blur"}],expression:"[\n              'name',\n              {rules: [\n                 {required: true, message: '请输入负责人姓名'},\n                 {max:8,message:'长度在8个汉字以内'}\n               ],\n               validateTrigger: 'blur'}\n            ]"}],attrs:{type:"text",autocomplete:"true"}})],1),a("a-form-item",e._b({attrs:{label:"岗位"}},"a-form-item",e.layout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["job",{rules:[{max:8,message:"长度在8个汉字以内"}],validateTrigger:"blur"}],expression:"[\n              'job',\n              {rules: [\n                 {max:8,message:'长度在8个汉字以内'}\n               ],\n               validateTrigger: 'blur'}\n            ]"}],attrs:{type:"text",autocomplete:"true"}})],1),a("a-form-item",e._b({attrs:{label:"邮箱"}},"a-form-item",e.layout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email",{rules:[{type:"email",message:"请输入正确邮箱地址"}],validateTrigger:"blur"}],expression:"[\n              'email',\n              {rules: [\n              {\n            type: 'email', message: '请输入正确邮箱地址',\n          }\n               ],\n               validateTrigger: 'blur'}\n            ]"}],attrs:{type:"email",autocomplete:"true",placeholder:"123456@163.com"}})],1),a("a-form-item",e._b({attrs:{label:"联系电话"}},"a-form-item",e.layout,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["telephone",{rules:[{required:!0,message:"请输入联系电话"},{pattern:/^[1][3,4,5,7,8][0-9]{9}$/,message:"联系电话格式错误"}],validateTrigger:"blur"}],expression:"[\n          'telephone',\n          {rules: [\n            {required: true, message: '请输入联系电话'},\n            {pattern:/^[1][3,4,5,7,8][0-9]{9}$/, message: '联系电话格式错误'}\n          ],\n            validateTrigger: 'blur'}\n         ]"}],attrs:{type:"phone",autocomplete:"true",placeholder:"13812341234"}})],1),a("a-form-item",e._b({attrs:{label:"备注"}},"a-form-item",e.layout,!1),[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["note",{rules:[{max:120,message:"长度在120个汉字以内"}],validateTrigger:"blur"}],expression:"[\n          'note',\n          {rules: [\n            {max:120, message:'长度在120个汉字以内'}\n          ],\n          validateTrigger: 'blur'}\n        ]"}],attrs:{placeholder:"请输入备注（不多于120字）",rows:4}})],1)],1)],1)},c=[],u=a("2f62"),m={name:"ContactModal",props:{record:Object,visible:Boolean,type:String},data:function(){return{layout:{"label-col":{span:8},"wrapper-col":{span:16}},form:this.$form.createForm(this),typeList:[],params:{project_id:this.projectSelected().id}}},mounted:function(){var e=this;o.getTypeList().then(function(t){console.log(t),e.typeList=t})},methods:Object(s["a"])({},Object(u["c"])(["projectSelected"]),{handleOk:function(){var e=this;this.form.validateFields(function(t,a){t||(a.company_type={value:a.company_type},e.isEdit?(a.id=e.record.id,o.updateAddressList(a).then(function(t){e.$emit("close"),e.$notification.success({message:"成功",description:"修改成功",key:"SUCCESS"})})):o.createAddressList(a,e.params).then(function(t){e.$emit("close"),e.$notification.success({message:"成功",description:"新建成功",key:"SUCCESS"})}))})},handleCancel:function(){this.$emit("close")}}),computed:{isEdit:function(){return"edit"===this.type},title:function(){return this.isEdit?"编辑":"新建"}}},d=m,p=a("2877"),b=Object(p["a"])(d,i,c,!1,null,"8343de1a",null),g=b.exports,v=[{title:"单位",dataIndex:"company",width:"10%",align:"center"},{title:"单位类型",dataIndex:"company_type.label",width:"14%",align:"center"},{title:"姓名",dataIndex:"name",width:"8%",align:"center"},{title:"岗位",dataIndex:"job",width:"10%",align:"center"},{title:"邮箱",dataIndex:"email",width:"17%",align:"center"},{title:"联系电话",dataIndex:"telephone",width:"15%",align:"center"},{title:"备注",dataIndex:"note",width:"13%",align:"center"},{title:"编辑",dataIndex:"operation",align:"center",scopedSlots:{customRender:"operation"}}],y={name:"RelatedCompany",components:{ContactModal:g},data:function(){return{layout:{xs:{span:12},sm:{span:8},xl:{span:4}},status:{loading:!0},params:{search:"",page:1,ordering:"-company",company_type:"",project_id:this.projectSelected().id},modal:{record:null,visible:!1,type:"1"},typeList:[],count:0,data:[],columns:v}},mounted:function(){var e=this;o.getTypeList().then(function(t){e.typeList=t}),this.getData()},methods:Object(s["a"])({},Object(u["c"])(["projectSelected"]),{handleClearParams:function(){this.params.ordering="company",this.params.search="",this.params.page=1,this.params.company_type="",this.getData()},handelePage:function(e){this.params.page=e,this.getData()},getData:function(){var e=this;this.status.loading=!0,o.getAddressList(this.params).then(function(t){e.data=t.results,e.count=t.count,e.status.loading=!1})},handleClose:function(){this.modal.type="",this.modal.record=null,this.modal.visible=!1,this.getData()},handleCreate:function(){this.modal.type="create",this.modal.record=null,this.modal.visible=!0},handleEdit:function(e){this.modal.type="edit",this.modal.record=e,this.modal.visible=!0},handleDelete:function(e){var t=this;o.deleteAddressListDetail(e.id).then(function(e){t.$notification.success({message:"成功",description:"删除成功",key:"SUCCESS"}),t.getData()}),this.getData()}})},f=y,_=(a("21b6"),Object(p["a"])(f,r,n,!1,null,"b9480b0c",null));t["default"]=_.exports},b63a:function(e,t,a){}}]);
//# sourceMappingURL=detail.fd278fd3.js.map